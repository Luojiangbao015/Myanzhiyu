<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>AGS课程笔记 | 凝雨个人博客</title><meta name="keywords" content="学习,变量"><meta name="author" content="凝雨"><meta name="copyright" content="凝雨"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="AGS课程笔记"><meta name="application-name" content="AGS课程笔记"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="AGS课程笔记"><meta property="og:url" content="http://example.com/2024/03/30/ue5/%E5%8F%98%E9%87%8F/AGS%E8%AF%BE%E7%A8%8B/index.html"><meta property="og:site_name" content="凝雨个人博客"><meta property="og:description" content="​"><meta property="og:locale" content="en"><meta property="og:image" content="http://example.com/img/ww/D004.png"><meta property="article:author" content="凝雨"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://example.com/img/ww/D004.png"><meta name="description" content="​"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="http://example.com/2024/03/30/ue5/%E5%8F%98%E9%87%8F/AGS%E8%AF%BE%E7%A8%8B/"><link rel="preconnect" href="//cdn.cbd.int"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/swiper/swiper.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: {"enable":true,"title":"与数百名博主无限进步","addFriendPlaceholder":"昵称（请勿包含博客等字样）：\n网站地址（要求博客地址，请勿提交个人主页）：\n头像图片url（请提供尽可能清晰的图片，我会上传到我自己的图床）：\n描述：\n站点截图（可选）：\n"},
  peoplecanvas: undefined,
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"tianli","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: undefined,
  greetingBox: {"enable":true,"default":"晚上好👋","list":[{"greeting":"晚安😴","startTime":0,"endTime":5},{"greeting":"早上好鸭👋, 祝你一天好心情！","startTime":6,"endTime":9},{"greeting":"上午好👋, 状态很好，鼓励一下～","startTime":10,"endTime":10},{"greeting":"11点多啦, 在坚持一下就吃饭啦～","startTime":11,"endTime":11},{"greeting":"午安👋, 宝贝","startTime":12,"endTime":14},{"greeting":"🌈充实的一天辛苦啦！","startTime":14,"endTime":18},{"greeting":"19点喽, 奖励一顿丰盛的大餐吧🍔。","startTime":19,"endTime":19},{"greeting":"晚上好👋, 在属于自己的时间好好放松😌~","startTime":20,"endTime":24}]},
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  music_page_default: "nav_music",
  root: '/',
  preloader: {"source":3},
  friends_vue_info: {"apiurl":"https://friends.anheyu.com/"},
  navMusic: true,
  mainTone: undefined,
  authorStatus: {"skills":["🤖️ 数码科技爱好者","🔍 分享与热心帮助","🏠 智能家居小能手","🔨 设计开发一条龙","🤝 专修交互与设计","🏃 脚踏实地行动派","🧱 团队小组发动机","💢 壮汉人狠话不多"]},
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: 'days',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"Author: 凝雨","link":"Link: ","source":"Source: 凝雨个人博客","info":"Copyright is owned by the author. For commercial reprints, please contact the author for authorization. For non-commercial reprints, please indicate the source.","copySuccess":"Copy success, copy and reprint please mark the address of this article"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"Traditional Chinese Activated Manually","cht_to_chs":"Simplified Chinese Activated Manually","day_to_night":"Dark Mode Activated Manually","night_to_day":"Light Mode Activated Manually","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: '凝雨个人博客',
  title: 'AGS课程笔记',
  postAI: '',
  pageFillDescription: '第一章添加玩家角色并控制, 第一节添加CPP基类, 第二节角色动画和装备武器, 第三节 角色状态机和动画, 第四节怪物动画, 第五节增强输入系统, 第六节添加相机及设置角色选择, 第二章, 第一节添加接口, UI, 创建血量UI, 代码, 用户控件基类, 控制器, 控制器子类, HUD, AuraCharacter.cpp*********************************************为初始化的地方, 配置GAS, 第一节添加CPP类和声明, 第二节创建实例, 第三节处理网络同步如上注释, 第四节属性声明, 项目, 代码文件夹, Ability System, UI MVC架构, 类, Ability System 技能管理, Actor 技能实例, 蓝图, ACS配置, 属性配置, UAttributeSet配置, PlayerState配置, 玩家配置, 添加和删除, 能力（Ability）, GA一般要做的事, 标签（Tags）, 输入（Input）, 高级（Advanced）, 成本（Costs）, 触发器（Triggers）, 冷却时间（Cooldowns）, 申请GE实现扣血, GE, 蓝图文件夹, AbilitySystem 能力系统, Aura, data 数据表格和数据资产, Enemy 怪物的技能和能力, GameplayCueNotifies 特效和音效等, GameplayTags 游戏标签数据表, Actor 演员(用于当玩家碰撞物品时将效果应用到玩家身上), Area 地火演员和GE, Crystal 水晶, FadeActor 建筑蓝图继承接口识别可点击点?, FlamePillar 火焰柱, Potion 药水, Test Actor 测试的演员, AI, AnimNotifies 动画通知, Character  角色  (除了玩家怪物都没用蓝图节点), Checkpoint 检查点 (用了蓝图), Game 游戏 (游戏单例类包含存储), Input 输入 (输入映射配置), MainMenu 主菜单 (开始界面), Player 玩家 (玩家控制器和玩家状态蓝图), SpawnVolumes 产卵量, UI 界面, data 数据表, HUD, ViewModel 数据模型, WidgetController 小部件控制器 继承者UObject第一章添加玩家角色并控制血量和蓝量制作及更新数据文件夹捡到瓶子增加生命和法力异常附着标签数据表属性菜单技能异步及火球发射火球发射和击中怪物怪物减血多敌人类型及敌人属性对属性计算暴击啥的网络敌人寻路避障敌人近战攻击行为和对玩家造成伤害敌人远程特殊攻击弹弓发射敌人法师攻击音乐粒子特效召唤场景搭建场景微调技能和经验等级向玩家状态添加属性作为成员变量及属性菜单升级技能菜单技能效果检疫技能升级效果雷电技能被动技能水晶技能冷却火焰爆炸保存保存世界地图入口第一节添加基类创建新项目创建抽象角色类玩家和怪物都继承自这个类命名文件夹分类为删除没必要的函数修改为添加装备组件智能指针挂载设置碰撞创建继承自的子类分别为玩家和怪物第二节角色动画和装备武器创建角色蓝图继承子类角色继承怪物继承将角色网格体设置为角色网格体武器绑定调整绑定武器调整绑定武器第三节角色状态机和动画创建状态机链接状态机添加动画链接混合动画动画事件图表打开角色蓝图将角色拖到进场景测试第四节怪物动画武器绑定同玩家的武器绑定添加动画蓝图创建怪物动作模板模板状态机混合状态添加怪物状态机设置混合动画第五节增强输入系统添加输入操作添加输入映射添加玩家控制器类文件夹头文件源文件检查输入映射是否有效获取增强输入系统添加映射上下文创建继承自的蓝图类选择控制器映射和控制器添加游戏基础模式蓝图选择玩家控制器及玩家蓝图在游戏世界场景切换游戏模式添加玩家出生点并运行第六节添加相机及设置角色选择打开角色蓝图添加弹簧臂弹簧臂下添加相机通过调整弹簧臂设置相机位置及角度前往玩家类控制玩家旋转头文件源文件返回引擎打开角色蓝图将弹簧臂取消将旋转朝向运动打开设置旋转速率为第二章属性架构处理技能行为树属性初始化和显示等简称是引擎里的内的功能组件它的主要功能包括技能冷却时间和技能消耗的管理同时也支持网络同步和实例支持开发者可以在事件中编写相关的技能逻辑如角色动作粒子效果以及角色数值的变动根据技能是否施展成功可以调用或来结束技能原文链接第一节添加接口创建文件夹类头文件代码声明接口类在怪物基类实现接口头文件继承接口类实现接口函数源文件实现接口函数创建血量尺寸框控件覆盖控件图片控件背景进度条控件样式填充图图片样式填充图改为图形填充百分比下至上外观填充透明样式背景透明度添加图片控件比例更新玻璃背景设置填充大小代码用户控件基类用户界面基类事件将传入的控制器对象赋值给类成员变量调用函数通知已经设置了控制器对象控制器控制器基类获取对象数据获取玩家控制器获取玩家状态获取能力组件获取属性集控制器子类生命值改变时发出通知最大生命值改变时发出通知覆盖层控制器子类当属性改变时发出通知当属性改变时绑定回调事件生命值改变时发出事件声明最大值改变时发出生命值改变时发出最大生命值改变时发出初始化属性时发出通知绑定属性回调绑定生命值回调绑定最大生命值回调绑定法力值回调绑定最大法力值回调当属性改变时发出通知事件基本在这发出和绑定玩家负责创建覆盖控件和绑定控制器覆盖控件通过结构体创建或者获取控制器初始化控制器数据覆盖控件类引用控制器实例指针控制器类引用判断控制器类类引用和状态类引用是否有效创建覆盖控件创建结构体并将参数构造获取设置覆盖控件的控制器发出事件添加到视口为初始化的地方初始化玩家角色能力系统和属性绑定委托未实现初始化控制器配置第一节添加类和声明打开插件添加的类添加的类在玩家基类添加前向声明玩家基类添加接口声明和对象实现接口函数实例添加类将角色声明的也复制一份进去前向声明也需要第二节创建实例玩家的需要在构造函数上实例设置网络同步同步技能冷却事件等这段代码是中的一部分用于设置一个玩家状态的网络更新频率怪物的需要在怪物基类构造函数实例基类属性创建默认子对象设置属性复制设定效果复制模式设置网络同步不同步技能冷却事件等这段代码的作用是创建并初始化一个默认的属性集作为该类的一个子对象第三节处理网络同步如上注释设置怪物和玩家网络同步带面见上边设置怪物代理在函数下初始化属性怪物自己持有怪物自己代理设置玩家代理在玩家基类下声明和重写两个虚函数服务器客户端实现自己持有代理玩家漏写第四节属性声明属性声明打开在虚幻引擎中是一个用于存储和管理游戏中实体如角色敌人等属性的数据结构它是基于的属性系统该系统设计用于高效地处理和同步这些属性尤其是在网络环境中类通常作为蓝图类或者类的一个成员变量来使用它允许开发者定义一系列属性如生命值魔法值力量等并提供了访问和修改这些属性值的接口这些属性可以被标记为需要在网络上同步以便于多人游戏中的状态同步要创建自定义的类你需要继承自并定义你的属性这通常涉及到使用宏来声明属性并可能使用来确保它们在网络上的客户端间正确同步此外你可能还需要实现一些逻辑来处理属性的变化例如当生命值减少到零时触发死亡事件设置访问宏在虚幻引擎的编程中是一个宏用于自动生成属性的存取器和函数这个宏常用于子类中以便于更便捷地操作游戏属性如角色的生命值能量攻击力等使用宏可以减少重复代码让代码更加简洁且易于维护它通常与属性声明一起使用自动为你生成相应的函数来读取和设置中的属性值属性声明生命值结构体是用来存储游戏属性的具体数值及其相关元数据的最大生命值魔法值最大魔法值属性函数在你的代码中是一个中的特殊函数用于处理网络复制过程中属性发生变化的情况当一个具有属性的变量在这个例子中似乎是尽管它没有直接展示出来在服务器上发生改变时此函数会在所有相关的客户端上被调用来反映这一变化确保所有玩家看到的游戏状态是一致的初始化属性注册属性在网络编程中宏用于控制特定或属性的生命周期管理特别是关于其在网络中的复制行为这个宏帮助你定义哪些属性应该在网络上同步以及在什么条件下同步同时还能在属性发生变化时触发自定义的通知回调这里指定了属性所属的类即属性集类它通常继承自并用于存储游戏角色的各种属性指定要管理其网络生命周期的属性名在这个上下文中是玩家或角色的一个关键属性需要在网络环境中实时同步这是同步条件表示没有特别的条件限制意味着无论何时只要属性值改变就会尝试进行同步在其他情况下可能会有比如仅当玩家拥有控制器或者仅当属性在特定范围内改变等条件这决定何时触发通知回调表明每次属性值改变时不论是在服务器还是客户端都会调用通知回调函数通常是这意味着每次值发生变动即使变动后的值与旧值相同也会触发通知属性函数实现宏的作用此宏会在编译时期生成必要的代码来自动调用函数当属性的值在服务器上发生变化时它确保了当属性的值由于服务器端的更新而有所不同时所有相关的客户端都会得到通知并执行相应的回调这是属性集类的名称即定义属性和复制逻辑的类这是你要为其添加复制通知的属性名称这意味着每当属性的值发生变化时框架都会自动处理网络同步这是传递给回调函数的参数名称表示属性更改前的旧值这允许你在回调中比较新旧值并做出相应处理项目代码文件夹文件夹中文能力系统演员人工智能动画通知角色检查站存档点游戏输入主菜单玩家产卵量技能鼠标类描述继承该类定义了一个游戏中的技能组件该类定义了一个名为的游戏能力继承自主要功能包括对目标造成伤害根据类默认值生成伤害效果参数获取当前等级下的伤害值包含多个编辑器属性如伤害类型伤害值减益效果等用于配置伤害行为该类定义了一个名为的被动技能基类继承自主要包含两个函数重写父类的激活能力函数用于初始化被动技能接收并处理被动技能被移除或失效的情况参数为一个游戏标签该类继承自主要用于游戏中的召唤功能主要功能如下返回一系列用于召唤的位置向量返回一个随机的召唤物小兵类设置需要召唤的小兵数量默认为存储可召唤的小兵类列表设置最小召唤距离默认为单位设置最大召唤距离默认为单位设置召唤物分布的角度范围默认为度该类继承自主要用于游戏中的某种伤害能力它包含虚拟函数返回技能描述虚拟函数返回升级后的技能描述成员变量存储最大碎片数量默认为该类继承自主要用于实现游戏中的一种光束法术能力其主要功能包括存储鼠标点击信息位置和演员追踪首个目标的位置存储额外的目标列表处理主要目标和额外目标死亡事件其中成员变量定义了鼠标点击位置点击到的演员拥有者控制器及角色等信息并设置了最大可追踪目标数量为该类继承自主要功能包括生成火球描述文本和方法召唤多个火球通过方法定义了火球数量属性默认为和火球类属性该类继承自主要用于实现游戏中的电击法术效果其功能包括重写方法用于获取当前等级的法术描述重写方法用于获取升级后的法术描述架构需要的代码小部件控制器负责操作数据小部件负责显示属性负责绘制小部件控件基类小部件控制类技能管理怪物召唤投射物光束继承雷电技能水晶碎片多火球继承投射物火球基类被动处理伤害技能实例火焰敌人生成敌人生成火球弹魔术圈点集合蓝图配置属性配置配置显示属性最大生命值配置指向的智能指针用于管理玩家的能力和效果指向的智能指针用于存储玩家的属性值如生命值魔法值等这段代码是中的一部分用于设置一个玩家状态的网络更新频率接口继承的方法返回玩家配置基类对象对象子类网络同步相关初始化玩家角色能力系统和属性玩家状态对玩家角色施加如果是怪物则改为绑定委托未实现添加和删除添加删除能力一般要做的事设置的等属性获取必要信息主要通过如果是通过调用的使用节点作为输入还可以通过获取编写逻辑如播放动画应用应用冲量等一定不要忘了标签能力标签取消带标签的能力锁定带标签的能力应为的误写激活拥有的标签激活被阻止的标签源所需标签源被阻止的标签目标所需标签目标被阻止的标签输入直接复制输入高级复制策略实例化策略服务器尊重远程能力取消重新触发实例化能力网络执行策略网络安全策略成本成本游戏效果类触发器能力触发器冷却时间冷却时间游戏效果类申请实现扣血编辑器状态文本持续时间立即生效永久生效周期内生效游戏效果组件修饰符执行游戏提示需要修饰符成功才能触发提示抑制叠加提示游戏提示叠加叠加类型蓝图文件夹能力系统定义能力系统包括和属性数据能力里边的蓝图好像是魔法阵的效果用于初始化数据的类数据表格和数据资产怪物的技能和能力特效和音效等游戏标签数据表演员用于当玩家碰撞物品时将效果应用到玩家身上地火演员和水晶建筑蓝图继承接口识别可点击点火焰柱药水测试的演员动画通知角色除了玩家怪物都没用蓝图节点检查点用了蓝图游戏游戏单例类包含存储输入输入映射配置主菜单开始界面玩家玩家控制器和玩家状态蓝图产卵量界面数据表数据模型小部件控制器继承者',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-02-07 23:24:05',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="/img/RR.jpg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://space.bilibili.com/253251579" title="哔哩哔哩"><img class="back-menu-item-icon" src="https://th.bing.com/th?id=ODLS.1e67f861-d980-4c01-ba66-9450f90172f4&amp;w=32&amp;h=32&amp;qlt=96&amp;pcl=fffffc&amp;o=6&amp;cb=15&amp;pid=1.2" alt="哔哩哔哩"/><span class="back-menu-item-text">哔哩哔哩</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://blender.kim/" title="魔酷网"><img class="back-menu-item-icon" src="https://th.bing.com/th?id=ODLS.88012746-d99b-4589-a17c-d5eeaad474fd&amp;w=32&amp;h=32&amp;qlt=99&amp;pcl=fffffc&amp;o=6&amp;cb=15&amp;pid=1.2" alt="魔酷网"/><span class="back-menu-item-text">魔酷网</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://www.aplaybox.com/" title="模之屋"><img class="back-menu-item-icon" src="https://th.bing.com/th?id=ODLS.221b96bc-0e7f-4f7d-b980-a051789b763b&amp;w=32&amp;h=32&amp;qlt=90&amp;pcl=fffffa&amp;o=6&amp;cb=15&amp;pid=1.2" alt="模之屋"/><span class="back-menu-item-text">模之屋</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://huaban.com/follow" title="花瓣"><img class="back-menu-item-icon" src="https://th.bing.com/th?id=ODLS.9e0310ad-0fa0-486f-8c12-81bcf016e199&amp;w=32&amp;h=32&amp;qlt=98&amp;pcl=fffffc&amp;o=6&amp;cb=15&amp;pid=1.2" alt="花瓣"/><span class="back-menu-item-text">花瓣</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://www.zhihu.com/people/35-4-25-32" title="知乎"><img class="back-menu-item-icon" src="https://th.bing.com/th?id=ODLS.66059014-8637-4840-b8a6-78e2a6e07c34&amp;w=17&amp;h=17&amp;o=6&amp;cb=15&amp;pid=1.2" alt="知乎"/><span class="back-menu-item-text">知乎</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">凝雨个人博客</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><i class="anzhiyufont anzhiyu-icon-artstation faa-tada" style="font-size: 0.9em;"></i><span> 朋友圈</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 追番页</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/htim/"><i class="anzhiyufont anzhiyu-icon-fan faa-tada" style="font-size: 0.9em;"></i><span> 小空调</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 闲言碎语</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/equipment/"><i class="anzhiyufont anzhiyu-icon-dice-d20 faa-tada" style="font-size: 0.9em;"></i><span> 我的装备</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> Search</span></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="/img/ds.png" target="_blank"><img class="post-qr-code-img" alt="微信" src="/img/ds.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/ds.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src="/img/ds.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> Newest Comments</span></div><div class="aside-list"><span>loading...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/%E5%8F%98%E9%87%8F/" style="font-size: 1.05rem;">变量<sup>5</sup></a><a href="/tags/%E5%A4%87%E5%BF%98%E5%BD%95/" style="font-size: 1.05rem;">备忘录<sup>1</sup></a><a href="/tags/%E5%AD%A6%E4%B9%A0/" style="font-size: 1.05rem;">学习<sup>35</sup></a><a href="/tags/%E8%84%9A%E6%9C%AC/" style="font-size: 1.05rem;">脚本<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>Archives</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/03/"><span class="card-archive-list-date">March 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">31</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/03/"><span class="card-archive-list-date">March 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">6</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/ue5/" itemprop="url">ue5</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/%E5%AD%A6%E4%B9%A0/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>学习</span></a><a class="article-meta__tags" href="/tags/%E5%8F%98%E9%87%8F/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>变量</span></a></span></div></div><h1 class="post-title" itemprop="name headline">AGS课程笔记</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2024-03-29T16:17:59.000Z" title="Created 2024-03-30 00:17:59">2024-03-30</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2025-02-07T15:24:05.744Z" title="Updated 2025-02-07 23:24:05">2025-02-07</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="文章字数"></i><span class="post-meta-label" title="文章字数">Word count:</span><span class="word-count" title="文章字数">7.7k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="阅读时长"></i><span class="post-meta-label" title="阅读时长">Reading time:</span><span>33min</span></span><span class="post-meta-separator"></span><span class="post-meta-pv-cv" id="" data-flag-title="AGS课程笔记"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">Post View:</span><span id="busuanzi_value_page_pv"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为贵州"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>贵州</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="/img/ww/D004.png"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="http://example.com/2024/03/30/ue5/%E5%8F%98%E9%87%8F/AGS%E8%AF%BE%E7%A8%8B/"><header><a class="post-meta-categories" href="/categories/ue5/" itemprop="url">ue5</a><a href="/tags/%E5%AD%A6%E4%B9%A0/" tabindex="-1" itemprop="url">学习</a><a href="/tags/%E5%8F%98%E9%87%8F/" tabindex="-1" itemprop="url">变量</a><h1 id="CrawlerTitle" itemprop="name headline">AGS课程笔记</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">凝雨</span><time itemprop="dateCreated datePublished" datetime="2024-03-29T16:17:59.000Z" title="Created 2024-03-30 00:17:59">2024-03-30</time><time itemprop="dateCreated datePublished" datetime="2025-02-07T15:24:05.744Z" title="Updated 2025-02-07 23:24:05">2025-02-07</time></header><p>​                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </p>
<h1 id="第一章-添加玩家角色并控制"><a href="#第一章-添加玩家角色并控制" class="headerlink" title="第一章:添加玩家角色并控制"></a>第一章:添加玩家角色并控制</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">26-35  HUD血量和蓝量UI制作及更新数据 UI文件夹 AuraHUD  Widget overlayWidget</span><br><span class="line">36-41 GE捡到瓶子增加生命和法力</span><br><span class="line">42-44-47  异常附着</span><br><span class="line">48-62 标签</span><br><span class="line">63-73 数据表</span><br><span class="line">74-94 属性菜单</span><br><span class="line">95-109 技能异步及火球发射</span><br><span class="line">110-124 火球发射和击中怪物,怪物减血</span><br><span class="line">125-129 多敌人类型及敌人属性</span><br><span class="line">130-146 对属性计算,暴击啥的</span><br><span class="line">147-160 网络?</span><br><span class="line">161-174 敌人AI寻路避障</span><br><span class="line">175-187 敌人近战攻击行为和对玩家造成伤害</span><br><span class="line">188-196 敌人远程特殊攻击? 弹弓发射</span><br><span class="line">197-200 敌人法师攻击</span><br><span class="line"></span><br><span class="line">2-27 音乐粒子特效召唤?</span><br><span class="line">28-32 场景搭建</span><br><span class="line">33-46 场景微调 技能和经验UI</span><br><span class="line">47-61 等级</span><br><span class="line">62-67 向玩家状态添加属性作为成员变量及属性菜单升级</span><br><span class="line">68-100 技能菜单</span><br><span class="line">101-113 技能效果,检疫</span><br><span class="line">114-135 技能升级效果,雷电技能</span><br><span class="line">136-142 被动技能</span><br><span class="line">143-160 水晶技能 冷却</span><br><span class="line">161-169 火焰爆炸</span><br><span class="line">170-192 保存</span><br><span class="line"></span><br><span class="line">1-14 保存世界</span><br><span class="line">15-31 地图入口</span><br></pre></td></tr></table></figure>



<h2 id="第一节-添加CPP基类"><a href="#第一节-添加CPP基类" class="headerlink" title="第一节:添加CPP基类"></a>第一节:添加CPP基类</h2><ol>
<li><p>创建新项目</p>
</li>
<li><p>创建C++抽象角色类<code>玩家和怪物都继承自这个类</code>,命名<strong>AuraCharacterBase</strong>,</p>
</li>
<li><p>文件夹分类为Character</p>
<ul>
<li><p>删除没必要的函数,修改<code>PrimaryActorTick.bCanEverTick = true</code>为<code>PrimaryActorTick.bCanEverTick = false</code></p>
</li>
<li><p>AAuraCharacterBase.h</p>
</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CoreMinimal.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;GameFramework/Character.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AuraCharacterBase.generated.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="built_in">UCLASS</span>(Abstract)</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">GAS_API</span> AAuraCharacterBase : <span class="keyword">public</span> ACharacter</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_BODY</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="comment">// Sets default values for this character&#x27;s properties</span></span><br><span class="line">	<span class="built_in">AAuraCharacterBase</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">	<span class="comment">// Called when the game starts or when spawned</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">BeginPlay</span><span class="params">()</span> <span class="keyword">override</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>AAuraCharacterBase.cpp</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Character/AuraCharacterBase.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Sets default values</span></span><br><span class="line">AAuraCharacterBase::<span class="built_in">AAuraCharacterBase</span>()</span><br><span class="line">&#123;</span><br><span class="line"> 	<span class="comment">// Set this character to call Tick() every frame.  You can turn this off to improve performance if you don&#x27;t need it.</span></span><br><span class="line">	PrimaryActorTick.bCanEverTick = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Called when the game starts or when spawned</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AAuraCharacterBase::BeginPlay</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Super::<span class="built_in">BeginPlay</span>();</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>添加装备组件</p>
<ul>
<li>AAuraCharacterBase.h</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CoreMinimal.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;GameFramework/Character.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AuraCharacterBase.generated.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="built_in">UCLASS</span>(Abstract)</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">GAS_API</span> AAuraCharacterBase : <span class="keyword">public</span> ACharacter</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_BODY</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="comment">// Sets default values for this character&#x27;s properties</span></span><br><span class="line">	<span class="built_in">AAuraCharacterBase</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">	<span class="comment">// Called when the game starts or when spawned</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">BeginPlay</span><span class="params">()</span> <span class="keyword">override</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//智能指针</span></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(EditAnywhere, Category = <span class="string">&quot;Combat&quot;</span>)</span><br><span class="line">	TObjectPtr&lt;USkeletalMeshComponent&gt;Weapon;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>AAuraCharacterBase.cpp</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Character/AuraCharacterBase.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Sets default values</span></span><br><span class="line">AAuraCharacterBase::<span class="built_in">AAuraCharacterBase</span>()</span><br><span class="line">&#123;</span><br><span class="line"> 	<span class="comment">// Set this character to call Tick() every frame.  You can turn this off to improve performance if you don&#x27;t need it.</span></span><br><span class="line">	PrimaryActorTick.bCanEverTick = <span class="literal">false</span>;</span><br><span class="line">    </span><br><span class="line">	<span class="comment">//挂载,设置碰撞</span></span><br><span class="line">	Weapon=<span class="built_in">CreateDefaultSubobject</span>&lt;USkeletalMeshComponent&gt;(<span class="string">&quot;Weapon&quot;</span>);</span><br><span class="line">	Weapon-&gt;<span class="built_in">SetupAttachment</span>(<span class="built_in">GetMesh</span>(), <span class="built_in">FName</span>(<span class="string">&quot;WeaponSocket&quot;</span>));</span><br><span class="line">	Weapon-&gt;<span class="built_in">SetCollisionEnabled</span>(ECollisionEnabled::NoCollision);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Called when the game starts or when spawned</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AAuraCharacterBase::BeginPlay</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Super::<span class="built_in">BeginPlay</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建继承自AuraCharacterBase的子类,分别为玩家Player和怪物Enemy</p>
</li>
</ol>
<h2 id="第二节-角色动画和装备武器"><a href="#第二节-角色动画和装备武器" class="headerlink" title="第二节:角色动画和装备武器"></a>第二节:角色动画和装备武器</h2><ol>
<li><p>创建角色蓝图,继承C++子类,角色继承Player,怪物继承Enemy</p>
</li>
<li><p>将角色网格体设置为角色网格体<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="/..%5C%E8%93%9D%E5%9B%BE%5CQQ%E6%88%AA%E5%9B%BE20240922025724.png" alt="QQ截图20240922025724"></p>
</li>
<li><p>武器绑定<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="/..%5C%E8%93%9D%E5%9B%BE%5C%E6%AD%A6%E5%99%A8%E7%BB%91%E5%AE%9A.png" alt="武器绑定"></p>
</li>
<li><p>调整绑定武器<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="/..%5C%E8%93%9D%E5%9B%BE%5C%E6%B7%BB%E5%8A%A0%E7%BB%91%E5%AE%9A%E6%AD%A6%E5%99%A8.png" alt="添加绑定武器"></p>
</li>
<li><p>调整绑定武器<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="/..%5C%E8%93%9D%E5%9B%BE%5C%E8%B0%83%E6%95%B4%E6%AD%A6%E5%99%A8.png" alt="调整武器"></p>
</li>
</ol>
<h2 id="第三节-角色状态机和动画"><a href="#第三节-角色状态机和动画" class="headerlink" title="第三节 :角色状态机和动画"></a>第三节 :角色状态机和动画</h2><ol>
<li>创建状态机<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="/..%5C%E8%93%9D%E5%9B%BE%5C%E5%88%9B%E5%BB%BA%E7%8A%B6%E6%80%81%E6%9C%BA.png" alt="创建状态机"></li>
<li>链接状态机<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="/..%5C%E8%93%9D%E5%9B%BE%5C%E9%93%BE%E6%8E%A5%E7%8A%B6%E6%80%81%E6%9C%BA.png" alt="链接状态机"></li>
<li>添加动画<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="/..%5C%E8%93%9D%E5%9B%BE%5C%E6%B7%BB%E5%8A%A0%E7%8A%B6%E6%80%81.png" alt="添加状态"></li>
<li>链接混合动画<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="/..%5C%E8%93%9D%E5%9B%BE%5C%E9%93%BE%E6%8E%A5%E6%B7%B7%E5%90%88%E5%8A%A8%E7%94%BB.png" alt="链接混合动画"></li>
<li>动画事件图表<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="G:\MyWep\source_posts\ue5\蓝图\布尔角色状态机.png" alt="布尔角色状态机"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="/..%5C%E8%93%9D%E5%9B%BE%5C%E5%8A%A8%E7%94%BB%E4%BA%8B%E4%BB%B6%E5%9B%BE%E8%A1%A8.png" alt="动画事件图表"></li>
<li>打开角色蓝图<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="/..%5C%E8%93%9D%E5%9B%BE%5C%E8%A7%92%E8%89%B2%E7%BB%91%E5%AE%9A%E8%93%9D%E5%9B%BE%E5%8A%A8%E7%94%BB.png" alt="角色绑定蓝图动画"></li>
<li>将角色拖到进场景测试</li>
</ol>
<h2 id="第四节-怪物动画"><a href="#第四节-怪物动画" class="headerlink" title="第四节:怪物动画"></a>第四节:怪物动画</h2><ol>
<li><p>武器绑定同玩家的武器绑定</p>
</li>
<li><p>添加动画蓝图创建怪物动作模板<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="/..%5C%E8%93%9D%E5%9B%BE%5C%E5%88%9B%E5%BB%BA%E6%80%AA%E7%89%A9%E5%8A%A8%E7%94%BB%E6%A8%A1%E6%9D%BF.png" alt="创建怪物动画模板"></p>
</li>
<li><p>模板状态机<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="/..%5C%E8%93%9D%E5%9B%BE%5C%E6%80%AA%E7%89%A9%E7%8A%B6%E6%80%81%E6%9C%BA.png" alt="怪物状态机"></p>
</li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="/..%5C%E8%93%9D%E5%9B%BE%5C%E6%B7%BB%E5%8A%A0%E6%80%AA%E7%89%A9%E7%8A%B6%E6%80%81%E6%9C%BA.png" alt="添加怪物状态机"></p>
<ol start="4">
<li><p>混合状态<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="/..%5C%E8%93%9D%E5%9B%BE%5C%E6%B7%B7%E5%90%88%E7%8A%B6%E6%80%81blend.png" alt="混合状态blend"></p>
</li>
<li><p>添加怪物状态机<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="/..%5C%E8%93%9D%E5%9B%BE%5C%E6%AD%A3%E5%BC%8F%E6%B7%BB%E5%8A%A0%E6%80%AA%E7%89%A9%E7%8A%B6%E6%80%81%E6%9C%BA.png" alt="正式添加怪物状态机"></p>
</li>
<li><p>设置混合动画<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="/..%5C%E8%93%9D%E5%9B%BE%5C%E8%AE%BE%E7%BD%AE%E6%80%AA%E7%89%A9%E7%8A%B6%E6%80%81%E6%B7%B7%E5%90%88%E7%A9%BA%E9%97%B4.png" alt="设置怪物状态混合空间"></p>
</li>
</ol>
<h2 id="第五节-增强输入系统"><a href="#第五节-增强输入系统" class="headerlink" title="第五节:增强输入系统"></a>第五节:增强输入系统</h2><ol>
<li>添加输入操作,<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="/..%5C%E8%93%9D%E5%9B%BE%5C%E6%9B%B4%E6%94%B9%E8%BE%93%E5%85%A5%E5%80%BC%E7%B1%BB%E5%9E%8B.png" alt="更改输入值类型"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="/..%5C%E8%93%9D%E5%9B%BE%5C%E6%B7%BB%E5%8A%A0%E8%BE%93%E5%85%A5%E6%93%8D%E4%BD%9C.png" alt="添加输入操作"></li>
<li>添加输入映射<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="/..%5C%E8%93%9D%E5%9B%BE%5C%E6%B7%BB%E5%8A%A0%E8%BE%93%E5%85%A5%E6%98%A0%E5%B0%84.png" alt="添加输入映射"></li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="/..%5C%E8%93%9D%E5%9B%BE%5C%E8%B0%83%E6%95%B4%E8%BE%93%E5%85%A5%E6%98%A0%E5%B0%84.png" alt="调整输入映射"></p>
<ol start="3">
<li><p>添加玩家控制器C++类,Player文件夹</p>
<ul>
<li>头文件AuraPlayerController.h</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CoreMinimal.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;GameFramework/PlayerController.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AuraPlayerController.generated.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UInputMappingContext</span>;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UInputAction</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">FInputActionValue</span>;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="built_in">UCLASS</span>()</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">GAS_API</span> AAuraPlayerController : <span class="keyword">public</span> APlayerController</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_BODY</span>()</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">AAuraPlayerController</span>();</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">BeginPlay</span><span class="params">()</span> <span class="keyword">override</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">SetupInputComponent</span><span class="params">()</span> <span class="keyword">override</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="built_in">UPROPERTY</span>(EditAnywhere, category = <span class="string">&quot;Input&quot;</span>);</span><br><span class="line">	TObjectPtr&lt;UInputMappingContext&gt; AuraContext;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(EditAnywhere, category = <span class="string">&quot;Input&quot;</span>);</span><br><span class="line">	TObjectPtr&lt;UInputAction&gt; MoveAction;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">Move</span><span class="params">(<span class="type">const</span> FInputActionValue&amp; InputActionValue)</span></span>;</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>源文件AuraPlayerController.cpp</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Player/AuraPlayerController.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;EnhancedInputSubsystems.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;EnhancedInputComponent.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">AAuraPlayerController::<span class="built_in">AAuraPlayerController</span>()</span><br><span class="line">&#123;</span><br><span class="line">	bReplicates = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AAuraPlayerController::BeginPlay</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Super::<span class="built_in">BeginPlay</span>();</span><br><span class="line">    <span class="comment">//检查输入映射是否有效</span></span><br><span class="line">	<span class="built_in">check</span>(AuraContext);</span><br><span class="line">	</span><br><span class="line">    <span class="comment">//获取增强输入系统</span></span><br><span class="line">	UEnhancedInputLocalPlayerSubsystem* Subsystem = ULocalPlayer::<span class="built_in">GetSubsystem</span>&lt;UEnhancedInputLocalPlayerSubsystem&gt;(<span class="built_in">GetLocalPlayer</span>());</span><br><span class="line"></span><br><span class="line">    <span class="comment">//添加映射上下文</span></span><br><span class="line">	Subsystem-&gt;<span class="built_in">AddMappingContext</span>(AuraContext, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">	bShowMouseCursor = <span class="literal">true</span>;</span><br><span class="line">	DefaultMouseCursor = EMouseCursor::Default;</span><br><span class="line"></span><br><span class="line">	FInputModeGameAndUI InputModeData;</span><br><span class="line">	InputModeData.<span class="built_in">SetLockMouseToViewportBehavior</span>(EMouseLockMode::DoNotLock);</span><br><span class="line">	InputModeData.<span class="built_in">SetHideCursorDuringCapture</span>(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">SetInputMode</span>(InputModeData);</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AAuraPlayerController::SetupInputComponent</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Super::<span class="built_in">SetupInputComponent</span>();</span><br><span class="line"></span><br><span class="line">	UEnhancedInputComponent* EnhancedInputComponent = <span class="built_in">CastChecked</span>&lt;UEnhancedInputComponent&gt;(InputComponent);</span><br><span class="line"></span><br><span class="line">	EnhancedInputComponent-&gt;<span class="built_in">BindAction</span>(MoveAction, ETriggerEvent::Triggered, <span class="keyword">this</span>, &amp;AAuraPlayerController::Move);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AAuraPlayerController::Move</span><span class="params">(<span class="type">const</span> FInputActionValue&amp; InputActionValue)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">const</span> FVector2D InputAxisVector = InputActionValue.<span class="built_in">Get</span>&lt;FVector2D&gt;();</span><br><span class="line">	<span class="type">const</span> FRotator Rotation = <span class="built_in">GetControlRotation</span>();</span><br><span class="line">	<span class="function"><span class="type">const</span> FRotator <span class="title">YawRotation</span><span class="params">(<span class="number">0.f</span>, Rotation.Yaw, <span class="number">0.f</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="type">const</span> FVector ForwardDirection = <span class="built_in">FRotationMatrix</span>(YawRotation).<span class="built_in">GetUnitAxis</span>(EAxis::X);</span><br><span class="line">	<span class="type">const</span> FVector RightDirection = <span class="built_in">FRotationMatrix</span>(YawRotation).<span class="built_in">GetUnitAxis</span>(EAxis::Y);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (APawn* ControlledPawn = <span class="built_in">GetPawn</span>&lt;APawn&gt;())</span><br><span class="line">	&#123;</span><br><span class="line">		ControlledPawn-&gt;<span class="built_in">AddMovementInput</span>(RightDirection * InputAxisVector.Y);</span><br><span class="line">		ControlledPawn-&gt;<span class="built_in">AddMovementInput</span>(ForwardDirection * InputAxisVector.X);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>创建继承自AuraPlayerController的蓝图类</li>
<li>选择控制器映射和控制器</li>
<li>添加游戏基础模式蓝图</li>
<li>选择玩家控制器及玩家蓝图<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="G:\MyWep\source_posts\ue5\蓝图\游戏模式设置.png" alt="游戏模式设置"></li>
<li>在游戏世界场景切换游戏模式,添加玩家出生点并运行</li>
</ol>
</li>
</ol>
<h2 id="第六节-添加相机及设置角色选择"><a href="#第六节-添加相机及设置角色选择" class="headerlink" title="第六节:添加相机及设置角色选择"></a>第六节:添加相机及设置角色选择</h2><ol>
<li><p>打开角色蓝图添加弹簧臂</p>
</li>
<li><p>弹簧臂下添加相机,通过调整弹簧臂设置相机位置及角度</p>
</li>
<li><p>前往玩家CPP类,AuraCharacter.h,控制玩家旋转</p>
<ul>
<li>头文件AuraCharacter.h</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CoreMinimal.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Character/AuraCharacterBase.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AuraCharacter.generated.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="built_in">UCLASS</span>()</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">GAS_API</span> AAuraCharacter : <span class="keyword">public</span> AAuraCharacterBase</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_BODY</span>()</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">AAuraCharacter</span>();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>源文件AuraCharacter.cpp</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Character/AuraCharacter.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;GameFramework/CharacterMovementComponent.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">AAuraCharacter::<span class="built_in">AAuraCharacter</span>()</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GetCharacterMovement</span>()-&gt;bOrientRotationToMovement = <span class="literal">true</span>;</span><br><span class="line">	<span class="built_in">GetCharacterMovement</span>()-&gt;RotationRate=<span class="built_in">FRotator</span>(<span class="number">0.0</span>, <span class="number">400.0f</span>, <span class="number">0.0</span>);</span><br><span class="line">	<span class="built_in">GetCharacterMovement</span>()-&gt;bConstrainToPlane=<span class="literal">true</span>;</span><br><span class="line">	<span class="built_in">GetCharacterMovement</span>()-&gt;bSnapToPlaneAtStart=<span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">	bUseControllerRotationRoll = <span class="literal">false</span>;</span><br><span class="line">	bUseControllerRotationPitch = <span class="literal">false</span>;</span><br><span class="line">	bUseControllerRotationYaw = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>返回引擎,打开角色蓝图,将弹簧臂</p>
</li>
<li><p>yaw取消,将旋转朝向运动打开,设置旋转速率为500<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="G:\MyWep\source\_posts\ue5\蓝图\设置弹簧臂摄像机.png" alt="设置弹簧臂摄像机" style="zoom: 200%;" /></p>
</li>
</ol>
<h1 id="第二章"><a href="#第二章" class="headerlink" title="第二章"></a>第二章</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">GAS,</span><br><span class="line">Attribute(属性),</span><br><span class="line">gameplay effects</span><br><span class="line">gameplay tags</span><br><span class="line">MVC 架构 处理UI</span><br><span class="line">gameplay ABILITIES  技能</span><br><span class="line">行为树</span><br></pre></td></tr></table></figure>

<p>​	GE  属性初始化和UI显示等…</p>
<p>GamplayAbility 简称 GA，是UE引擎里的GAS内的功能组件，它的主要功能包括技能冷却时间（CD）和技能消耗的管理，同时也支持网络同步和实例支持。开发者可以在ActivateAbility事件中编写相关的技能逻辑，如角色动作、粒子效果以及角色数值的变动。根据技能是否施展成功，可以调用CommitAbility()或EndAbility()来结束技能。<br>————————————————</p>
<p>原文链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_30100043/article/details/137234914">https://blog.csdn.net/qq_30100043/article/details/137234914</a></p>
<h2 id="第一节-添加接口"><a href="#第一节-添加接口" class="headerlink" title="第一节:添加接口"></a>第一节:添加接口</h2><ol>
<li><p>创建Interaction文件夹C++类EnemyInteraction<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="G:\MyWep\source_posts\ue5\蓝图\接口类.png" alt="接口类"></p>
<ul>
<li>EnemyInteraction头文件代码</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CoreMinimal.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;UObject/Interface.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;EnemyInterface.generated.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// This class does not need to be modified.</span></span><br><span class="line"><span class="built_in">UINTERFACE</span>(MinimalAPI)</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UEnemyInterface</span> : <span class="keyword">public</span> UInterface</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_BODY</span>()</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">GAS_API</span> IEnemyInterface</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_BODY</span>()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Add interface functions to this class. This is the class that will be inherited to implement this interface.</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">//声明接口类</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">HighightActor</span><span class="params">()</span></span>=<span class="number">0</span>;</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">UnHighlightActor</span><span class="params">()</span></span>=<span class="number">0</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>在怪物基类实现接口AuraEnemy.h</p>
<ul>
<li>头文件</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CoreMinimal.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Character/AuraCharacterBase.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Interface/EnemyInterface.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AuraEnemy.generated.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="built_in">UCLASS</span>()  <span class="comment">//继承接口类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">GAS_API</span> AAuraEnemy : <span class="keyword">public</span> AAuraCharacterBase,<span class="keyword">public</span> IEnemyInterface</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_BODY</span>()</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">//实现接口函数</span></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">HighightActor</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">UnHighlightActor</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>源文件</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Character/AuraEnemy.h&quot;</span></span></span><br><span class="line"><span class="comment">//实现接口函数</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AAuraEnemy::HighightActor</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AAuraEnemy::UnHighlightActor</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="UI"><a href="#UI" class="headerlink" title="UI"></a>UI</h1><h2 id="创建血量UI"><a href="#创建血量UI" class="headerlink" title="创建血量UI"></a>创建血量UI</h2><ul>
<li><p>尺寸框控件-SizeBox_Root</p>
</li>
<li><p>覆盖控件-Overlay_Root</p>
</li>
<li><p>图片控件[背景]-Image_Background</p>
</li>
<li><p>进度条控件</p>
<ul>
<li>样式-填充图&#x3D;图片</li>
<li>样式-填充图-改为图形填充</li>
<li>百分比&#x3D;1</li>
<li>下至上</li>
<li>外观-填充透明A&#x3D;1</li>
<li>样式-背景-透明度&#x3D;0</li>
</ul>
</li>
<li><p>添加图片控件-比例</p>
<ul>
<li>更新玻璃背景</li>
<li>设置填充大小</li>
</ul>
</li>
</ul>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><h3 id="用户控件基类"><a href="#用户控件基类" class="headerlink" title="用户控件基类"></a>用户控件基类</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CoreMinimal.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Blueprint/UserWidget.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AuraUserWidget.generated.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 用户界面基类</span></span><br><span class="line"><span class="built_in">UCLASS</span>()</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AURADEMO_API</span> UAuraUserWidget : <span class="keyword">public</span> UUserWidget</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_BODY</span>()</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">UFUNCTION</span>(BlueprintCallable)</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">SetWidgetController</span><span class="params">(UObject* InWidgetController)</span></span>;</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintReadOnly)</span><br><span class="line">	TObjectPtr&lt;UObject&gt; WidgetController;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">	<span class="comment">//事件</span></span><br><span class="line">	<span class="built_in">UFUNCTION</span>(BlueprintImplementableEvent)</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">WidgetControllerSet</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;UI/Widget/AuraUserWidget.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAuraUserWidget::SetWidgetController</span><span class="params">(UObject* InWidgetController)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// 将传入的Widget控制器对象赋值给类成员变量WidgetController</span></span><br><span class="line">	WidgetController = InWidgetController;</span><br><span class="line">	<span class="comment">// 调用WidgetControllerSet函数，通知已经设置了Widget控制器对象</span></span><br><span class="line">	<span class="built_in">WidgetControllerSet</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="控制器"><a href="#控制器" class="headerlink" title="控制器"></a>控制器</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CoreMinimal.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AuraWidgetController.generated.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UAttributeSet</span>;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UAbilitySystemComponent</span>;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UAbilitySystemComponent</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">USTRUCT</span>(BlueprintType)</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">FWidgetControllerParame</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_BODY</span>()</span><br><span class="line"></span><br><span class="line">	<span class="built_in">FWidgetControllerParame</span>()&#123;&#125;;</span><br><span class="line">	<span class="built_in">FWidgetControllerParame</span>(APlayerController* PC, APlayerState* PS, UAbilitySystemComponent* InAbiliASCtySystemComponent, UAttributeSet* AS)</span><br><span class="line">	: <span class="built_in">PlayerController</span>(PC), <span class="built_in">PlayerState</span>(PS), <span class="built_in">AbilitySystemComponent</span>(InAbiliASCtySystemComponent), <span class="built_in">AttributeSet</span>(AS)</span><br><span class="line">	&#123;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(EditAnywhere, BlueprintReadWrite)</span><br><span class="line">	TObjectPtr&lt;APlayerController&gt; PlayerController=<span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(EditAnywhere, BlueprintReadWrite)</span><br><span class="line">	TObjectPtr&lt;APlayerState&gt; PlayerState=<span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(EditAnywhere, BlueprintReadWrite)</span><br><span class="line">	TObjectPtr&lt;UAbilitySystemComponent&gt; AbilitySystemComponent=<span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(EditAnywhere, BlueprintReadWrite)</span><br><span class="line">	TObjectPtr&lt;UAttributeSet&gt; AttributeSet=<span class="literal">nullptr</span>;</span><br><span class="line">	</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//控制器基类</span></span><br><span class="line"><span class="built_in">UCLASS</span>()</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AURADEMO_API</span> UAuraWidgetController : <span class="keyword">public</span> UObject</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_BODY</span>()</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">UFUNCTION</span>(BlueprintCallable)</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">SetWidgetControllerParams</span><span class="params">(<span class="type">const</span> FWidgetControllerParame&amp; WCParams)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">BroadcastInitialValues</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">BindCallbacksToDependencies</span><span class="params">()</span></span>;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*获取对象数据*/</span></span><br><span class="line">	<span class="comment">//获取玩家控制器</span></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintReadOnly, Category=<span class="string">&quot;WidgetController&quot;</span>)</span><br><span class="line">	TObjectPtr&lt;APlayerController&gt; PlayerController;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//获取玩家状态</span></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintReadOnly, Category=<span class="string">&quot;WidgetController&quot;</span>)</span><br><span class="line">	TObjectPtr&lt;APlayerState&gt; PlayerState;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//获取能力组件</span></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintReadOnly, Category=<span class="string">&quot;WidgetController&quot;</span>)</span><br><span class="line">	TObjectPtr&lt;UAbilitySystemComponent&gt; AbilitySystemComponent;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//获取属性集</span></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintReadOnly, Category=<span class="string">&quot;WidgetController&quot;</span>)</span><br><span class="line">	TObjectPtr&lt;UAttributeSet&gt; AttributeSet;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;UI/WidgetController/AuraWidgetController.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAuraWidgetController::SetWidgetControllerParams</span><span class="params">(<span class="type">const</span> FWidgetControllerParame&amp; WCParams)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	PlayerController = WCParams.PlayerController;</span><br><span class="line">	PlayerState = WCParams.PlayerState;</span><br><span class="line">	AbilitySystemComponent = WCParams.AbilitySystemComponent;</span><br><span class="line">	AttributeSet = WCParams.AttributeSet;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAuraWidgetController::BroadcastInitialValues</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAuraWidgetController::BindCallbacksToDependencies</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="控制器子类"><a href="#控制器子类" class="headerlink" title="控制器子类"></a>控制器子类</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CoreMinimal.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;UI/WidgetController/AuraWidgetController.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;OverlayWidgetController.generated.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">FOnAttributeChangeData</span>;</span><br><span class="line"><span class="comment">//生命值改变时发出通知</span></span><br><span class="line"><span class="built_in">DECLARE_DYNAMIC_MULTICAST_DELEGATE_OneParam</span>(FOnHealtChangedSignature, <span class="type">float</span>, NewHealt);</span><br><span class="line"><span class="comment">//最大生命值改变时发出通知</span></span><br><span class="line"><span class="built_in">DECLARE_DYNAMIC_MULTICAST_DELEGATE_OneParam</span>(FOnMaxHealtChangedSignature,<span class="type">float</span> , NewMaxHealt);</span><br><span class="line"><span class="built_in">DECLARE_DYNAMIC_MULTICAST_DELEGATE_OneParam</span>(FOnManaChangedSignature, <span class="type">float</span>, NewMana);</span><br><span class="line"><span class="built_in">DECLARE_DYNAMIC_MULTICAST_DELEGATE_OneParam</span>(FOnMaxManaChangedSignature,<span class="type">float</span> , NewMaxMana);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 覆盖层控制器子类</span></span><br><span class="line"><span class="built_in">UCLASS</span>(Blueprintable,BlueprintType)</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AURADEMO_API</span> UOverlayWidgetController : <span class="keyword">public</span> UAuraWidgetController</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_BODY</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="comment">//当属性改变时发出通知</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">BroadcastInitialValues</span><span class="params">()</span> <span class="keyword">override</span></span>;</span><br><span class="line">	<span class="comment">//当属性改变时绑定回调</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">BindCallbacksToDependencies</span><span class="params">()</span> <span class="keyword">override</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//事件:生命值改变时发出</span></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintAssignable, Category = <span class="string">&quot;GAS|Attributes&quot;</span>)</span><br><span class="line">	FOnHealtChangedSignature OnHealtChanged;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//事件:声明最大值改变时发出</span></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintAssignable, Category = <span class="string">&quot;GAS|Attributes&quot;</span>)</span><br><span class="line">	FOnMaxHealtChangedSignature OnMaxHealtChanged;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintAssignable, Category = <span class="string">&quot;GAS|Attributes&quot;</span>)</span><br><span class="line">	FOnManaChangedSignature OnManaChanged;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintAssignable, Category = <span class="string">&quot;GAS|Attributes&quot;</span>)</span><br><span class="line">	FOnMaxManaChangedSignature OnMaxManaChanged;</span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">	<span class="comment">// 生命值改变时发出</span></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">HealthChanged</span><span class="params">(<span class="type">const</span> FOnAttributeChangeData&amp; Data)</span> <span class="type">const</span></span>;</span><br><span class="line">	<span class="comment">// 最大生命值改变时发出</span></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">MaxHealthChanged</span><span class="params">(<span class="type">const</span> FOnAttributeChangeData&amp; Data)</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">ManaChanged</span><span class="params">(<span class="type">const</span> FOnAttributeChangeData&amp; Data)</span> <span class="type">const</span></span>;</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">MaxManaChanged</span><span class="params">(<span class="type">const</span> FOnAttributeChangeData&amp; Data)</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;UI/WidgetController/OverlayWidgetController.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AbilitySystem/AuraAttributeSet.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">										<span class="comment">/*初始化属性时发出通知*/</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UOverlayWidgetController::BroadcastInitialValues</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Super::<span class="built_in">BroadcastInitialValues</span>();</span><br><span class="line">	<span class="type">const</span> UAuraAttributeSet* AuraAttributeSet = <span class="built_in">CastChecked</span>&lt;UAuraAttributeSet&gt;(AttributeSet);</span><br><span class="line">	OnHealtChanged.<span class="built_in">Broadcast</span>(AuraAttributeSet-&gt;<span class="built_in">GetHealth</span>());</span><br><span class="line">	OnMaxHealtChanged.<span class="built_in">Broadcast</span>(AuraAttributeSet-&gt;<span class="built_in">GetMaxHealth</span>());</span><br><span class="line">	OnManaChanged.<span class="built_in">Broadcast</span>(AuraAttributeSet-&gt;<span class="built_in">GetMana</span>());</span><br><span class="line">	OnMaxManaChanged.<span class="built_in">Broadcast</span>(AuraAttributeSet-&gt;<span class="built_in">GetMaxMana</span>());</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">											<span class="comment">/*绑定属性回调*/</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UOverlayWidgetController::BindCallbacksToDependencies</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Super::<span class="built_in">BindCallbacksToDependencies</span>();</span><br><span class="line">	<span class="type">const</span> UAuraAttributeSet* AuraAttributeSet = <span class="built_in">CastChecked</span>&lt;UAuraAttributeSet&gt;(AttributeSet);</span><br><span class="line">	<span class="comment">//绑定生命值回调</span></span><br><span class="line">	AbilitySystemComponent-&gt;<span class="built_in">GetGameplayAttributeValueChangeDelegate</span>(</span><br><span class="line">		AuraAttributeSet-&gt;<span class="built_in">GetHealthAttribute</span>()).<span class="built_in">AddUObject</span>(<span class="keyword">this</span>, &amp;UOverlayWidgetController::HealthChanged);</span><br><span class="line">	<span class="comment">//绑定最大生命值回调</span></span><br><span class="line">	AbilitySystemComponent-&gt;<span class="built_in">GetGameplayAttributeValueChangeDelegate</span>(</span><br><span class="line">		AuraAttributeSet-&gt;<span class="built_in">GetMaxHealthAttribute</span>()).<span class="built_in">AddUObject</span>(<span class="keyword">this</span>, &amp;UOverlayWidgetController::MaxHealthChanged);</span><br><span class="line">	<span class="comment">//绑定法力值回调</span></span><br><span class="line">	AbilitySystemComponent-&gt;<span class="built_in">GetGameplayAttributeValueChangeDelegate</span>(</span><br><span class="line">		AuraAttributeSet-&gt;<span class="built_in">GetManaAttribute</span>()).<span class="built_in">AddUObject</span>(<span class="keyword">this</span>, &amp;UOverlayWidgetController::ManaChanged);</span><br><span class="line">	<span class="comment">//绑定最大法力值回调</span></span><br><span class="line">	AbilitySystemComponent-&gt;<span class="built_in">GetGameplayAttributeValueChangeDelegate</span>(</span><br><span class="line">		AuraAttributeSet-&gt;<span class="built_in">GetMaxManaAttribute</span>()).<span class="built_in">AddUObject</span>(<span class="keyword">this</span>, &amp;UOverlayWidgetController::MaxManaChanged);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                                       <span class="comment">/*当属性改变时发出通知*/</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UOverlayWidgetController::HealthChanged</span><span class="params">(<span class="type">const</span> FOnAttributeChangeData&amp; Data)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	OnHealtChanged.<span class="built_in">Broadcast</span>(Data.NewValue);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UOverlayWidgetController::MaxHealthChanged</span><span class="params">(<span class="type">const</span> FOnAttributeChangeData&amp; Data)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	OnMaxHealtChanged.<span class="built_in">Broadcast</span>(Data.NewValue);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UOverlayWidgetController::ManaChanged</span><span class="params">(<span class="type">const</span> FOnAttributeChangeData&amp; Data)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	OnManaChanged.<span class="built_in">Broadcast</span>(Data.NewValue);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UOverlayWidgetController::MaxManaChanged</span><span class="params">(<span class="type">const</span> FOnAttributeChangeData&amp; Data)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	OnMaxManaChanged.<span class="built_in">Broadcast</span>(Data.NewValue);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="HUD"><a href="#HUD" class="headerlink" title="HUD"></a>HUD</h3><ul>
<li>事件基本在这发出和绑定</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CoreMinimal.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;GameFramework/HUD.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;UI/Widget/AuraUserWidget.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AuraHUD.generated.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UOverlayWidgetController</span>;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UAuraUserWidget</span>;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UAttributeSet</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">FWidgetControllerParame</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//玩家HUD,负责创建覆盖控件和绑定控制器</span></span><br><span class="line"><span class="built_in">UCLASS</span>(Blueprintable, BlueprintType)</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AURADEMO_API</span> AAuraHUD : <span class="keyword">public</span> AHUD</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_BODY</span>()</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="comment">//覆盖控件</span></span><br><span class="line">	<span class="built_in">UPROPERTY</span>()</span><br><span class="line">	TObjectPtr&lt;UAuraUserWidget&gt; OverlayWidget;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//通过结构体创建或者获取控制器</span></span><br><span class="line">	<span class="function">UOverlayWidgetController *<span class="title">GetOverlayWidgetController</span><span class="params">(<span class="type">const</span> FWidgetControllerParame&amp; WCParams)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 初始化控制器数据</span></span><br><span class="line">	<span class="built_in">UFUNCTION</span>(BlueprintCallable)</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">InitOverlay</span><span class="params">(APlayerController* PC, APlayerState* PS, UAbilitySystemComponent* ASC, UAttributeSet* AS)</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="comment">//覆盖控件类引用</span></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(EditAnywhere)</span><br><span class="line">	TSubclassOf&lt;UAuraUserWidget&gt; OverlayWidgetClass;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//控制器实例指针</span></span><br><span class="line">	<span class="built_in">UPROPERTY</span>()</span><br><span class="line">	TObjectPtr&lt;UOverlayWidgetController&gt; OverlayWidgetController;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//控制器类引用</span></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(EditAnywhere)</span><br><span class="line">	TSubclassOf&lt;UOverlayWidgetController&gt; OverlayWidgetControllerClass;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;UI/HUD/AuraHUD.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;UI/WidgetController/OverlayWidgetController.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">UOverlayWidgetController* <span class="title">AAuraHUD::GetOverlayWidgetController</span><span class="params">(<span class="type">const</span> FWidgetControllerParame&amp; WCParams)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(OverlayWidgetController == <span class="literal">nullptr</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		OverlayWidgetController = <span class="built_in">NewObject</span>&lt;UOverlayWidgetController&gt;(<span class="keyword">this</span>, OverlayWidgetControllerClass);</span><br><span class="line">		OverlayWidgetController-&gt;<span class="built_in">SetWidgetControllerParams</span>(WCParams);</span><br><span class="line">		OverlayWidgetController-&gt;<span class="built_in">BindCallbacksToDependencies</span>();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> OverlayWidgetController;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AAuraHUD::InitOverlay</span><span class="params">(APlayerController* PC, APlayerState* PS, UAbilitySystemComponent* ASC, UAttributeSet* AS)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//判断控制器类类引用和状态UI类引用是否有效</span></span><br><span class="line">	<span class="built_in">checkf</span>(OverlayWidgetClass, <span class="built_in">TEXT</span>(<span class="string">&quot;OverlayWidgetClass is nullptr&quot;</span>))</span><br><span class="line">	<span class="built_in">checkf</span>(OverlayWidgetControllerClass, <span class="built_in">TEXT</span>(<span class="string">&quot;OverlayWidgetControllerClass is nullptr&quot;</span>))</span><br><span class="line"></span><br><span class="line">	<span class="comment">//创建覆盖控件</span></span><br><span class="line">	UUserWidget * Widget = <span class="built_in">CreateWidget</span>&lt;UUserWidget&gt;(<span class="built_in">GetWorld</span>(), OverlayWidgetClass);</span><br><span class="line">	OverlayWidget= <span class="built_in">Cast</span>&lt;UAuraUserWidget&gt;(Widget);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//创建结构体并将参数构造</span></span><br><span class="line">	<span class="type">const</span> FWidgetControllerParame FWidgetControllerParame = &#123;PC, PS, ASC, AS&#125;;</span><br><span class="line">	<span class="comment">//获取OverlayWidgetController</span></span><br><span class="line">	UOverlayWidgetController * WidgetController = <span class="built_in">GetOverlayWidgetController</span>(FWidgetControllerParame);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//设置覆盖控件的控制器,发出事件</span></span><br><span class="line">	OverlayWidget-&gt;<span class="built_in">SetWidgetController</span>(WidgetController);</span><br><span class="line">	WidgetController-&gt;<span class="built_in">BroadcastInitialValues</span>();</span><br><span class="line"></span><br><span class="line">	<span class="comment">//添加到视口</span></span><br><span class="line">	Widget-&gt;<span class="built_in">AddToViewport</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="AuraCharacter-cpp-为初始化的地方"><a href="#AuraCharacter-cpp-为初始化的地方" class="headerlink" title="AuraCharacter.cpp*********************************************为初始化的地方"></a>AuraCharacter.cpp*********************************************为初始化的地方</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Character/AuraCharacter.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AbilitySystem/AuraAbilitySystemComponent.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Player/AuraPlayerController.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Player/AuraPlayerState.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;UI/HUD/AuraHUD.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AAuraCharacter::PossessedBy</span><span class="params">(AController* NewController)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Super::<span class="built_in">PossessedBy</span>(NewController);</span><br><span class="line">	<span class="built_in">InitAbilityActorInfo</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AAuraCharacter::OnRep_PlayerState</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Super::<span class="built_in">OnRep_PlayerState</span>();</span><br><span class="line">	<span class="built_in">InitAbilityActorInfo</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AAuraCharacter::InitAbilityActorInfo</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">/*初始化玩家角色能力系统和属性*/</span></span><br><span class="line">	AAuraPlayerState* AuraPlayerState = <span class="built_in">GetPlayerState</span>&lt;AAuraPlayerState&gt;();</span><br><span class="line">	<span class="built_in">check</span>(AuraPlayerState);</span><br><span class="line">	AuraPlayerState-&gt;<span class="built_in">GetAbilitySystemComponent</span>()-&gt;<span class="built_in">InitAbilityActorInfo</span>(AuraPlayerState, <span class="keyword">this</span>);</span><br><span class="line">	<span class="built_in">Cast</span>&lt;UAuraAbilitySystemComponent&gt;(AuraPlayerState-&gt;<span class="built_in">GetAbilitySystemComponent</span>())-&gt;<span class="built_in">AbilityActorInfoSet</span>();<span class="comment">//绑定委托,未实现</span></span><br><span class="line">	AbilitySystemComponent = AuraPlayerState-&gt;<span class="built_in">GetAbilitySystemComponent</span>();</span><br><span class="line">	AttributeSet = AuraPlayerState-&gt;<span class="built_in">GetAttributeSet</span>();</span><br><span class="line"></span><br><span class="line">	<span class="comment">//初始化Mvc控制器*********************************************</span></span><br><span class="line">	<span class="keyword">if</span>(AAuraPlayerController* AuraPlayerController = <span class="built_in">Cast</span>&lt;AAuraPlayerController&gt;(<span class="built_in">GetController</span>()))</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(AAuraHUD* AuraHUD = <span class="built_in">Cast</span>&lt;AAuraHUD&gt;(AuraPlayerController-&gt;<span class="built_in">GetHUD</span>()))</span><br><span class="line">		&#123;</span><br><span class="line">			AuraHUD-&gt;<span class="built_in">InitOverlay</span>(AuraPlayerController, AuraPlayerState, AbilitySystemComponent, AttributeSet);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="配置GAS"><a href="#配置GAS" class="headerlink" title="配置GAS"></a>配置GAS</h1><h2 id="第一节-添加CPP类和声明"><a href="#第一节-添加CPP类和声明" class="headerlink" title="第一节:添加CPP类和声明"></a>第一节:添加CPP类和声明</h2><ul>
<li><p>打开插件添加UAbilitySystemComponent的c++类</p>
</li>
<li><p>添加UAttributeSet的c++类</p>
</li>
<li><p>在玩家基类添加前向声明</p>
</li>
<li><pre><code class="language-cpp">class UAbilitySystemComponent;
class UAttributeSet;
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">3. 玩家基类添加IAbilitySystemInterface接口</span><br><span class="line">4. 声明IAbilitySystemInterface和UAttributeSet对象</span><br><span class="line"></span><br><span class="line">5. 实现接口函数virtual UAbilitySystemComponent* GetAbilitySystemComponent() const override</span><br><span class="line"></span><br><span class="line">   ```cpp</span><br><span class="line">   return IAbilitySystemInterface实例</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
</ul>
<ol start="6">
<li>添加APlayerState c++类,将角色声明的UAbilitySystemComponent也复制一份进去,前向声明也需要</li>
</ol>
<h2 id="第二节-创建实例"><a href="#第二节-创建实例" class="headerlink" title="第二节:创建实例"></a>第二节:创建实例</h2><ul>
<li>玩家的需要在AAuraPlayerState构造函数上实例</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">AAuraPlayerState::<span class="built_in">AAuraPlayerState</span>()</span><br><span class="line">&#123;</span><br><span class="line">	AbilitySystemComponent = <span class="built_in">CreateDefaultSubobject</span>&lt;UAuraAbilitySystemComponent&gt;(<span class="string">&quot;AbilitySystemComponent&quot;</span>);</span><br><span class="line">	AbilitySystemComponent-&gt;<span class="built_in">SetIsReplicated</span>(<span class="literal">true</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//设置网络同步 同步技能冷却事件等</span></span><br><span class="line">	AbilitySystemComponent-&gt;<span class="built_in">SetReplicationMode</span>(EGameplayEffectReplicationMode::Mixed);</span><br><span class="line"></span><br><span class="line">	AttributeSet = <span class="built_in">CreateDefaultSubobject</span>&lt;UAuraAttributeSet&gt;(<span class="string">&quot;AttributeSet&quot;</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//这段C++代码是Unreal Engine中的一部分，用于设置一个玩家状态(AAuraPlayerState)的网络更新频率</span></span><br><span class="line">	NetUpdateFrequency=<span class="number">100.f</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>怪物的需要在怪物基类构造函数实例</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">ACharacterEnemy::<span class="built_in">ACharacterEnemy</span>()</span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">//基类AbilitySystemComponent属性</span></span><br><span class="line">	<span class="comment">//创建默认子对象:</span></span><br><span class="line">	<span class="comment">//设置属性复制:</span></span><br><span class="line">	<span class="comment">//设定效果复制模式:</span></span><br><span class="line">	AbilitySystemComponent = <span class="built_in">CreateDefaultSubobject</span>&lt;UAuraAbilitySystemComponent&gt;(<span class="string">&quot;AbilitySystemComponent&quot;</span>);</span><br><span class="line">	AbilitySystemComponent-&gt;<span class="built_in">SetIsReplicated</span>(<span class="literal">true</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//设置网络同步,不同步技能冷却事件等</span></span><br><span class="line">	AbilitySystemComponent-&gt;<span class="built_in">SetReplicationMode</span>(EGameplayEffectReplicationMode::Minimal);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//这段代码的作用是创建并初始化一个默认的属性集(UAuraAttributeSet)作为该类的一个子对象。</span></span><br><span class="line">	AttributeSet = <span class="built_in">CreateDefaultSubobject</span>&lt;UAuraAttributeSet&gt;(<span class="string">&quot;AttributeSet&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="第三节-处理网络同步-如上注释"><a href="#第三节-处理网络同步-如上注释" class="headerlink" title="第三节:处理网络同步,如上注释"></a>第三节:处理网络同步,如上注释</h2><ul>
<li><p>设置怪物和玩家网络同步AbilitySystemComponent-&gt;SetReplicationMode(EGameplayEffectReplicationMode::Minimal); 带面见上边</p>
</li>
<li><p>设置怪物代理,在BeginPlay函数下</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">ACharacterEnemy::BeginPlay</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Super::<span class="built_in">BeginPlay</span>();</span><br><span class="line">	<span class="built_in">check</span>(AbilitySystemComponent)</span><br><span class="line">	<span class="comment">//初始化属性? 怪物自己持有,怪物自己代理</span></span><br><span class="line">	AbilitySystemComponent-&gt;<span class="built_in">InitAbilityActorInfo</span>(<span class="keyword">this</span>,<span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置玩家代理,在玩家基类下声明InitAbilityActorInfo()和重写两个虚函数</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">PossessedBy</span><span class="params">(AController* NewController)</span> <span class="keyword">override</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ACharacterBase::PossessedBy</span><span class="params">(AController* NewController)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//服务器</span></span><br><span class="line">	Super::<span class="built_in">PossessedBy</span>(NewController);</span><br><span class="line">	<span class="built_in">InitAbilityActorInfo</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">OnRep_PlayerState</span><span class="params">()</span> <span class="keyword">override</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ACharacterBase::OnRep_PlayerState</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//客户端</span></span><br><span class="line">	Super::<span class="built_in">OnRep_PlayerState</span>();</span><br><span class="line">	<span class="built_in">InitAbilityActorInfo</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>实现 自己持有,代理玩家</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">ACharacterBase::InitAbilityActorInfo</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	AAuraPlayerState* AuraPlayerState = <span class="built_in">GetPlayerState</span>&lt;AAuraPlayerState&gt;();</span><br><span class="line">	<span class="built_in">check</span>(AuraPlayerState);</span><br><span class="line">	AuraPlayerState-&gt;<span class="built_in">GetAbilitySystemComponent</span>()-&gt;<span class="built_in">InitAbilityActorInfo</span>(AuraPlayerState, <span class="keyword">this</span>);  </span><br><span class="line">	<span class="built_in">Cast</span>&lt;UAuraAbilitySystemComponent&gt;(AuraPlayerState-&gt;<span class="built_in">GetAbilitySystemComponent</span>())-&gt;<span class="built_in">AbilityActorInfoSet</span>(); <span class="comment">//漏写</span></span><br><span class="line">	AbilitySystemComponent = AuraPlayerState-&gt;<span class="built_in">GetAbilitySystemComponent</span>();</span><br><span class="line">	AttributeSet = AuraPlayerState-&gt;<span class="built_in">GetAttributeSet</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="第四节-属性声明"><a href="#第四节-属性声明" class="headerlink" title="第四节:属性声明"></a>第四节:属性声明</h2><ul>
<li><p>属性声明打开UAttributeSet</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*在虚幻引擎5（UE5）中，UAttributeSet 是一个用于存储和管理游戏中实体（如角色、敌人等）属性的数据结构。</span></span><br><span class="line"><span class="comment"> *它是基于 Unreal 的属性系统（Attribute System），该系统设计用于高效地处理和同步这些属性，尤其是在网络环境中。</span></span><br><span class="line"><span class="comment">UAttributeSet 类通常作为蓝图类或者C++类的一个成员变量来使用，</span></span><br><span class="line"><span class="comment">它允许开发者定义一系列属性，如生命值（Health）、魔法值（Mana）、力量（Strength）等，并提供了访问和修改这些属性值的接口。</span></span><br><span class="line"><span class="comment">这些属性可以被标记为需要在网络上同步，以便于多人游戏中的状态同步。</span></span><br><span class="line"><span class="comment">要创建自定义的 UAttributeSet 类，你需要继承自 UAttributeSet 并定义你的属性。</span></span><br><span class="line"><span class="comment">这通常涉及到使用 UPROPERTY() 宏来声明属性，并可能使用 UPROPERTY(Replicated) 来确保它们在网络上的客户端间正确同步。</span></span><br><span class="line"><span class="comment">此外，你可能还需要实现一些逻辑来处理属性的变化，例如当生命值减少到零时触发死亡事件*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CoreMinimal.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AttributeSet.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AbilitySystemComponent.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AuraAttributeSet.generated.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//设置访问宏</span></span><br><span class="line"><span class="comment">//在虚幻引擎（Unreal Engine）的C++编程中，</span></span><br><span class="line"><span class="comment">//ATTRIBUTE_ACCESSORS 是一个宏，用于自动生成属性（Attribute）的存取器（Getter 和 Setter）函数。</span></span><br><span class="line"><span class="comment">//这个宏常用于UAttributeSet子类中，以便于更便捷地操作游戏属性，如角色的生命值、能量、攻击力等</span></span><br><span class="line"><span class="comment">//使用 ATTRIBUTE_ACCESSORS 宏可以减少重复代码，让代码更加简洁且易于维护。</span></span><br><span class="line"><span class="comment">//它通常与属性声明一起使用，自动为你生成相应的函数来读取和设置 FGameplayAttributeData 中的属性值。</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ATTRIBUTE_ACCESSORS(ClassName, PropertyName) \</span></span><br><span class="line"><span class="meta">GAMEPLAYATTRIBUTE_PROPERTY_GETTER(ClassName, PropertyName) \</span></span><br><span class="line"><span class="meta">GAMEPLAYATTRIBUTE_VALUE_GETTER(PropertyName) \</span></span><br><span class="line"><span class="meta">GAMEPLAYATTRIBUTE_VALUE_SETTER(PropertyName) \</span></span><br><span class="line"><span class="meta">GAMEPLAYATTRIBUTE_VALUE_INITTER(PropertyName)</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="built_in">UCLASS</span>()</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">GASDEMO_API</span> UAuraAttributeSet : <span class="keyword">public</span> UAttributeSet</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_BODY</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">UAuraAttributeSet</span>();</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">GetLifetimeReplicatedProps</span><span class="params">(TArray&lt;FLifetimeProperty&gt;&amp; OutLifetimeProps)</span> <span class="type">const</span> <span class="keyword">override</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*属性声明*/</span></span><br><span class="line">	<span class="comment">//生命值</span></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintReadOnly, ReplicatedUsing = OnRep_Health, Category = <span class="string">&quot;Primary Attributes&quot;</span>)</span><br><span class="line">	FGameplayAttributeData Health;                  <span class="comment">//GameplayAttributeData 结构体是用来存储游戏属性的具体数值及其相关元数据的</span></span><br><span class="line">	<span class="built_in">ATTRIBUTE_ACCESSORS</span>(UAuraAttributeSet, Health); </span><br><span class="line">	<span class="comment">//最大生命值</span></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintReadOnly, ReplicatedUsing = OnRep_MaxHealth, Category = <span class="string">&quot;Primary Attributes&quot;</span>)</span><br><span class="line">	FGameplayAttributeData MaxHealth;</span><br><span class="line">	<span class="built_in">ATTRIBUTE_ACCESSORS</span>(UAuraAttributeSet, MaxHealth);</span><br><span class="line">	<span class="comment">//魔法值</span></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintReadOnly, ReplicatedUsing = OnRep_Mana, Category = <span class="string">&quot;Primary Attributes&quot;</span>)</span><br><span class="line">	FGameplayAttributeData Mana;</span><br><span class="line">	<span class="built_in">ATTRIBUTE_ACCESSORS</span>(UAuraAttributeSet, Mana);</span><br><span class="line">	<span class="comment">//最大魔法值</span></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintReadOnly, ReplicatedUsing = OnRep_MaxMana, Category = <span class="string">&quot;Primary Attributes&quot;</span>)</span><br><span class="line">	FGameplayAttributeData MaxMana;</span><br><span class="line">	<span class="built_in">ATTRIBUTE_ACCESSORS</span>(UAuraAttributeSet, MaxMana);</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*属性函数*/</span></span><br><span class="line">	<span class="comment">//在你的代码中，OnRep_Health 是一个 Unreal Engine 中的特殊函数，用于处理网络复制（replication）过程中属性发生变化的情况。</span></span><br><span class="line">	<span class="comment">//当一个具有 replicated 属性的变量（在这个例子中似乎是Health，尽管它没有直接展示出来）在服务器上发生改变时，</span></span><br><span class="line">	<span class="comment">//此函数会在所有相关的客户端上被调用来反映这一变化，确保所有玩家看到的游戏状态是一致的</span></span><br><span class="line">	<span class="built_in">UFUNCTION</span>()</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">OnRep_Health</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldHealth)</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UFUNCTION</span>()</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">OnRep_MaxHealth</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldMaxHealth)</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UFUNCTION</span>()</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">OnRep_Mana</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldMana)</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UFUNCTION</span>()</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">OnRep_MaxMana</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldMaxMana)</span> <span class="type">const</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AbilitySystem/AuraAttributeSet.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AbilitySystemComponent.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Net/UnrealNetwork.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">UAuraAttributeSet::<span class="built_in">UAuraAttributeSet</span>()</span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">//初始化属性</span></span><br><span class="line">	<span class="built_in">InitHealth</span>(<span class="number">100.f</span>);</span><br><span class="line">	<span class="built_in">InitMaxHealth</span>(<span class="number">100.f</span>);</span><br><span class="line">	<span class="built_in">InitMana</span>(<span class="number">50.f</span>);</span><br><span class="line">	<span class="built_in">InitMaxMana</span>(<span class="number">50.f</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAuraAttributeSet::GetLifetimeReplicatedProps</span><span class="params">(TArray&lt;FLifetimeProperty&gt;&amp; OutLifetimeProps)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Super::<span class="built_in">GetLifetimeReplicatedProps</span>(OutLifetimeProps);</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*注册属性*/</span></span><br><span class="line">	<span class="comment">//在Unreal Engine网络编程中，DOREPLIFETIME_CONDITION_NOTIFY 宏用于控制特定Actor或ActorComponent属性的生命周期管理，</span></span><br><span class="line">	<span class="comment">//特别是关于其在网络中的复制行为。</span></span><br><span class="line">	<span class="comment">//这个宏帮助你定义哪些属性应该在网络上同步，以及在什么条件下同步，同时还能在属性发生变化时触发自定义的通知回调。</span></span><br><span class="line">	<span class="comment">//UAuraAttributeSet: 这里指定了属性所属的类，即属性集类，它通常继承自 UAttributeSet 并用于存储游戏角色的各种属性。</span></span><br><span class="line">	<span class="comment">//Health: 指定要管理其网络生命周期的属性名。在这个上下文中，Health 是玩家或角色的一个关键属性，需要在网络环境中实时同步</span></span><br><span class="line">	<span class="comment">//COND_None: 这是同步条件。COND_None 表示没有特别的条件限制，意味着无论何时只要属性值改变就会尝试进行同步。</span></span><br><span class="line">	<span class="comment">//在其他情况下，可能会有比如仅当玩家拥有控制器 (COND_OwnerOnly) 或者仅当属性在特定范围内改变 (COND_SkipIfNotDirty) 等条件。</span></span><br><span class="line">	<span class="comment">//EPNOTIFY_Always: 这决定何时触发通知回调。REPNOTIFY_Always 表明每次属性值改变时，不论是在服务器还是客户端，都会调用通知回调函数（通常是 OnRep_Health）。</span></span><br><span class="line">	<span class="comment">//这意味着每次 Health 值发生变动，即使变动后的值与旧值相同，也会触发通知。</span></span><br><span class="line">	<span class="built_in">DOREPLIFETIME_CONDITION_NOTIFY</span>(UAuraAttributeSet, Health, COND_None, REPNOTIFY_Always);</span><br><span class="line">	<span class="built_in">DOREPLIFETIME_CONDITION_NOTIFY</span>(UAuraAttributeSet, MaxHealth, COND_None, REPNOTIFY_Always);</span><br><span class="line">	<span class="built_in">DOREPLIFETIME_CONDITION_NOTIFY</span>(UAuraAttributeSet, Mana, COND_None, REPNOTIFY_Always);</span><br><span class="line">	<span class="built_in">DOREPLIFETIME_CONDITION_NOTIFY</span>(UAuraAttributeSet, MaxMana, COND_None, REPNOTIFY_Always);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*属性函数实现*/</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAuraAttributeSet::OnRep_Health</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldHealth)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//宏的作用：此宏会在编译时期生成必要的代码来自动调用 OnRep_Health 函数，当 Health 属性的值在服务器上发生变化时。</span></span><br><span class="line">	<span class="comment">//它确保了当属性的值由于服务器端的更新而有所不同时，所有相关的客户端都会得到通知，并执行相应的 OnRep_Health 回调。</span></span><br><span class="line">	<span class="comment">//UAuraAttributeSet：这是属性集类的名称，即定义属性和复制逻辑的类。</span></span><br><span class="line">	<span class="comment">//Health：这是你要为其添加复制通知的属性名称。这意味着每当 Health 属性的值发生变化时，框架都会自动处理网络同步。</span></span><br><span class="line">	<span class="comment">//ldHealth：这是传递给 OnRep_Health 回调函数的参数名称，表示属性更改前的旧值。这允许你在回调中比较新旧值并做出相应处理</span></span><br><span class="line">	<span class="built_in">GAMEPLAYATTRIBUTE_REPNOTIFY</span>(UAuraAttributeSet, Health, OldHealth);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAuraAttributeSet::OnRep_MaxHealth</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldMaxHealth)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">GAMEPLAYATTRIBUTE_REPNOTIFY</span>(UAuraAttributeSet, MaxHealth, OldMaxHealth);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAuraAttributeSet::OnRep_Mana</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldMana)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">GAMEPLAYATTRIBUTE_REPNOTIFY</span>(UAuraAttributeSet, Mana, OldMana);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAuraAttributeSet::OnRep_MaxMana</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldMaxMana)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">GAMEPLAYATTRIBUTE_REPNOTIFY</span>(UAuraAttributeSet, MaxMana, OldMaxMana);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="项目"><a href="#项目" class="headerlink" title="项目"></a>项目</h1><h2 id="代码文件夹"><a href="#代码文件夹" class="headerlink" title="代码文件夹"></a>代码文件夹</h2><table>
<thead>
<tr>
<th>文件夹</th>
<th>中文</th>
</tr>
</thead>
<tbody><tr>
<td>Ability System</td>
<td>能力系统</td>
</tr>
<tr>
<td>Actor</td>
<td>演员</td>
</tr>
<tr>
<td>AI</td>
<td>人工智能</td>
</tr>
<tr>
<td>Anim Notifies</td>
<td>动画通知</td>
</tr>
<tr>
<td>Characte</td>
<td>角色</td>
</tr>
<tr>
<td>checkpoint</td>
<td>检查站,存档点</td>
</tr>
<tr>
<td>Game</td>
<td>游戏</td>
</tr>
<tr>
<td>Input</td>
<td>输入</td>
</tr>
<tr>
<td>MainMenu</td>
<td>主菜单</td>
</tr>
<tr>
<td>Player</td>
<td>玩家</td>
</tr>
<tr>
<td>Spawn Volumes</td>
<td>产卵量</td>
</tr>
<tr>
<td>UI</td>
<td>UI</td>
</tr>
</tbody></table>
<h2 id="Ability-System"><a href="#Ability-System" class="headerlink" title="Ability System"></a>Ability System</h2><ul>
<li>Abilities 技能</li>
<li>AbilityTasks 鼠标</li>
</ul>
<table>
<thead>
<tr>
<th>类</th>
<th>描述</th>
<th>继承</th>
</tr>
</thead>
<tbody><tr>
<td>AuraGameplayAbility</td>
<td>该C++类定义了一个游戏中的技能组件</td>
<td>UGameplayAbility</td>
</tr>
<tr>
<td>UAuraDamageGameplayAbility</td>
<td>&#x2F;&#x2F;该C++类定义了一个名为UAuraDamageGameplayAbility的游戏能力，继承自UAuraGameplayAbility。主要功能包括： &#x2F;&#x2F; CauseDamage：对目标造成伤害。 &#x2F;&#x2F; MakeDamageEffectParamsFromClassDefaults：根据类默认值生成伤害效果参数。 &#x2F;&#x2F; GetDamageAtLevel：获取当前等级下的伤害值。 &#x2F;&#x2F; 包含多个编辑器属性，如伤害类型、伤害值、减益效果等，用于配置伤害行为</td>
<td>AuraGameplayAbility</td>
</tr>
<tr>
<td>UAuraPassiveAbility</td>
<td>&#x2F;&#x2F; 该C++类定义了一个名为UAuraPassiveAbility的被动技能基类，继承自UAuraGameplayAbility。主要包含两个函数： &#x2F;&#x2F; ActivateAbility：重写父类的激活能力函数，用于初始化被动技能。 &#x2F;&#x2F; ReceiveDeactivate：接收并处理被动技能被移除或失效的情况，参数为一个游戏标签</td>
<td>AuraGameplayAbility</td>
</tr>
<tr>
<td>UAuraSummonAbility</td>
<td>&#x2F;&#x2F; 该C++类UAuraSummonAbility继承自UAuraGameplayAbility，主要用于游戏中的召唤功能。主要功能如下： &#x2F;&#x2F; GetSpawnLocations：返回一系列用于召唤的位置向量。 &#x2F;&#x2F; GetRandomMinionClass：返回一个随机的召唤物（小兵）类。 &#x2F;&#x2F; NumMinions：设置需要召唤的小兵数量，默认为5。 &#x2F;&#x2F; MinionClasses：存储可召唤的小兵类列表。 &#x2F;&#x2F; MinSpawnDistance：设置最小召唤距离，默认为50单位。 &#x2F;&#x2F; MaxSpawnDistance：设置最大召唤距离，默认为250单位。 &#x2F;&#x2F; SpawnSpread：设置召唤物分布的角度范围，默认为90度。</td>
<td>AuraGameplayAbility</td>
</tr>
<tr>
<td>UArcaneShards</td>
<td>&#x2F;&#x2F;该C++类UArcaneShards继承自UAuraDamageGameplayAbility，主要用于游戏中的某种伤害能力。它包含： &#x2F;&#x2F; 虚拟函数GetDescription，返回技能描述。 &#x2F;&#x2F; 虚拟函数GetNextLevelDescription，返回升级后的技能描述。 &#x2F;&#x2F; 成员变量MaxNumShards，存储最大碎片数量，默认为11。</td>
<td>UAuraDamageGameplayAbility</td>
</tr>
<tr>
<td>UAuraBeamSpell</td>
<td>&#x2F;&#x2F; 该C++类UAuraBeamSpell继承自UAuraDamageGameplayAbility，主要用于实现游戏中的一种光束法术能力。其主要功能包括： &#x2F;&#x2F; 存储鼠标点击信息（位置和演员）。 &#x2F;&#x2F; 追踪首个目标的位置。 &#x2F;&#x2F; 存储额外的目标列表。 &#x2F;&#x2F; 处理主要目标和额外目标死亡事件。 &#x2F;&#x2F; 其中成员变量定义了鼠标点击位置、点击到的演员、拥有者控制器及角色等信息，并设置了最大可追踪目标数量为5。</td>
<td>UAuraDamageGameplayAbility</td>
</tr>
<tr>
<td>UAuraFireBlast</td>
<td>&#x2F;&#x2F; 该C++类UAuraFireBlast继承自UAuraDamageGameplayAbility，主要功能包括： &#x2F;&#x2F; 生成火球描述文本（GetDescription和GetNextLevelDescription方法）。 &#x2F;&#x2F; 召唤多个火球（通过SpawnFireBalls方法）。 &#x2F;&#x2F; 定义了火球数量（NumFireBalls属性，默认为12）和火球类（FireBallClass属性）</td>
<td>UAuraDamageGameplayAbility</td>
</tr>
<tr>
<td>UAuraMeleeAttack</td>
<td></td>
<td>UAuraDamageGameplayAbility</td>
</tr>
<tr>
<td>UElectrocute</td>
<td>&#x2F;&#x2F; 该C++类UElectrocute继承自UAuraBeamSpell，主要用于实现游戏中的“电击”法术效果。其功能包括： &#x2F;&#x2F; 重写GetDescription方法，用于获取当前等级的法术描述。 &#x2F;&#x2F; 重写GetNextLevelDescription方法，用于获取升级后的法术描述。</td>
<td>UAuraBeamSpell</td>
</tr>
<tr>
<td>UAuraFireBolt</td>
<td></td>
<td>UAuraProjectileSpell</td>
</tr>
<tr>
<td>UElectrocute</td>
<td></td>
<td>UAuraBeamSpell</td>
</tr>
</tbody></table>
<p>graph TD;<br>    A–&gt;B;<br>    A–&gt;C;<br>    B–&gt;D;</p>
<h2 id="UI-MVC架构"><a href="#UI-MVC架构" class="headerlink" title="UI MVC架构"></a>UI MVC架构</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">需要的代码</span><br><span class="line">小部件控制器 负责操作数据</span><br><span class="line">小部件 负责显示属性</span><br><span class="line">HUD 负责绘制小部件</span><br></pre></td></tr></table></figure>



<ul>
<li>HUD</li>
<li>ViewModel MVVM</li>
<li>Widget 控件基类</li>
<li>WidgetController  小部件控制</li>
</ul>
<h1 id="类"><a href="#类" class="headerlink" title="类"></a>类</h1><h2 id="Ability-System-技能管理"><a href="#Ability-System-技能管理" class="headerlink" title="Ability System 技能管理"></a>Ability System 技能管理</h2><table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><strong>AuraSummonAbility</strong></td>
<td>怪物召唤</td>
</tr>
<tr>
<td>ProjectileSpell</td>
<td>投射物</td>
</tr>
<tr>
<td>UAuraBeamSpell</td>
<td>光束</td>
</tr>
<tr>
<td><strong>Electrocute</strong>：继承UArcaneShards</td>
<td>雷电技能</td>
</tr>
<tr>
<td>UArcaneShards</td>
<td>水晶碎片</td>
</tr>
<tr>
<td>UAuraFireBlast</td>
<td>多火球</td>
</tr>
<tr>
<td>UAuraFireBolt：继承投射物ProjectileSpell</td>
<td>火球</td>
</tr>
<tr>
<td>UAuraGameplayAbility</td>
<td>基类</td>
</tr>
<tr>
<td>UAuraPassiveAbility</td>
<td>被动</td>
</tr>
<tr>
<td>UAuraDamageGameplayAbility</td>
<td>处理伤害</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<h2 id="Actor-技能实例"><a href="#Actor-技能实例" class="headerlink" title="Actor 技能实例"></a>Actor 技能实例</h2><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>AuraEffectActor</td>
<td>火焰</td>
<td></td>
</tr>
<tr>
<td>AuraEnemySpawnPoint</td>
<td>敌人生成</td>
<td></td>
</tr>
<tr>
<td>Enemy Spawn Volume</td>
<td>敌人生成</td>
<td></td>
</tr>
<tr>
<td>Fire Ball</td>
<td>火球</td>
<td></td>
</tr>
<tr>
<td>AuraProjectile</td>
<td>弹</td>
<td></td>
</tr>
<tr>
<td>Magic Circle</td>
<td>魔术圈</td>
<td></td>
</tr>
<tr>
<td>Point Collection</td>
<td>点集合</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h1 id="蓝图"><a href="#蓝图" class="headerlink" title="蓝图"></a>蓝图</h1><h2 id="ACS配置"><a href="#ACS配置" class="headerlink" title="ACS配置"></a>ACS配置</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Copyright Epic Games, Inc. All Rights Reserved.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> UnrealBuildTool;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GasDemo</span> : ModuleRules</span><br><span class="line">&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">GasDemo</span><span class="params">(ReadOnlyTargetRules Target)</span> : base(Target)</span></span><br><span class="line"><span class="function">	&#123;</span></span><br><span class="line">		PCHUsage = PCHUsageMode.UseExplicitOrSharedPCHs;</span><br><span class="line">	</span><br><span class="line">		PublicDependencyModuleNames.<span class="built_in">AddRange</span>(<span class="keyword">new</span> string[] &#123; <span class="string">&quot;Core&quot;</span>, <span class="string">&quot;CoreUObject&quot;</span>, <span class="string">&quot;Engine&quot;</span>, <span class="string">&quot;InputCore&quot;</span>,<span class="string">&quot;EnhancedInput&quot;</span>, <span class="string">&quot;GameplayAbilities&quot;</span> &#125;);</span><br><span class="line"></span><br><span class="line">		PrivateDependencyModuleNames.<span class="built_in">AddRange</span>(<span class="keyword">new</span> string[] &#123; <span class="string">&quot;GameplayTags&quot;</span>, <span class="string">&quot;GameplayTasks&quot;</span>, <span class="string">&quot;NavigationSystem&quot;</span>, <span class="string">&quot;Niagara&quot;</span>, <span class="string">&quot;AIModule&quot;</span> &#125;);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// Uncomment if you are using Slate UI</span></span><br><span class="line">		<span class="comment">// PrivateDependencyModuleNames.AddRange(new string[] &#123; &quot;Slate&quot;, &quot;SlateCore&quot; &#125;);</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">// Uncomment if you are using online features</span></span><br><span class="line">		<span class="comment">// PrivateDependencyModuleNames.Add(&quot;OnlineSubsystem&quot;);</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">// To include OnlineSubsystemSteam, add it to the plugins section in your uproject file with the Enabled attribute set to true</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="属性配置"><a href="#属性配置" class="headerlink" title="属性配置"></a>属性配置</h2><h3 id="UAttributeSet配置"><a href="#UAttributeSet配置" class="headerlink" title="UAttributeSet配置"></a>UAttributeSet配置</h3><p>showdebug abilitysystem 显示属性</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CoreMinimal.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AttributeSet.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AbilitySystemComponent.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;MyAttributeSet.generated.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ATTRIBUTE_ACCESSORS(ClassName, PropertyName) \</span></span><br><span class="line"><span class="meta">GAMEPLAYATTRIBUTE_PROPERTY_GETTER(ClassName, PropertyName) \</span></span><br><span class="line"><span class="meta">GAMEPLAYATTRIBUTE_VALUE_GETTER(PropertyName) \</span></span><br><span class="line"><span class="meta">GAMEPLAYATTRIBUTE_VALUE_SETTER(PropertyName) \</span></span><br><span class="line"><span class="meta">GAMEPLAYATTRIBUTE_VALUE_INITTER(PropertyName)</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">UCLASS</span>()</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">JIANGBAODEMO_API</span> UMyAttributeSet : <span class="keyword">public</span> UAttributeSet</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_BODY</span>()</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UMyAttributeSet</span>();</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">GetLifetimeReplicatedProps</span><span class="params">(TArray&lt;FLifetimeProperty&gt;&amp; OutLifetimeProps)</span> <span class="type">const</span> <span class="keyword">override</span></span>;</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintReadOnly, ReplicatedUsing = OnRep_Health, Category = <span class="string">&quot;Primary Attributes&quot;</span>)</span><br><span class="line">	FGameplayAttributeData Health;                  </span><br><span class="line">	<span class="built_in">ATTRIBUTE_ACCESSORS</span>(UMyAttributeSet, Health); </span><br><span class="line">	<span class="comment">//最大生命值</span></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintReadOnly, ReplicatedUsing = OnRep_MaxHealth, Category = <span class="string">&quot;Primary Attributes&quot;</span>)</span><br><span class="line">	FGameplayAttributeData MaxHealth;</span><br><span class="line">	<span class="built_in">ATTRIBUTE_ACCESSORS</span>(UMyAttributeSet, MaxHealth);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UFUNCTION</span>()</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">OnRep_Health</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldHealth)</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UFUNCTION</span>()</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">OnRep_MaxHealth</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldMaxHealth)</span> <span class="type">const</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;MyAttributeSet.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AbilitySystemComponent.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Net/UnrealNetwork.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">UMyAttributeSet::<span class="built_in">UMyAttributeSet</span>()</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">InitHealth</span>(<span class="number">100.f</span>);</span><br><span class="line">	<span class="built_in">InitMaxHealth</span>(<span class="number">100.f</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UMyAttributeSet::GetLifetimeReplicatedProps</span><span class="params">(TArray&lt;FLifetimeProperty&gt;&amp; OutLifetimeProps)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Super::<span class="built_in">GetLifetimeReplicatedProps</span>(OutLifetimeProps);</span><br><span class="line">	<span class="built_in">DOREPLIFETIME_CONDITION_NOTIFY</span>(UMyAttributeSet, Health, COND_None, REPNOTIFY_Always);</span><br><span class="line">	<span class="built_in">DOREPLIFETIME_CONDITION_NOTIFY</span>(UMyAttributeSet, MaxHealth, COND_None, REPNOTIFY_Always);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UMyAttributeSet::OnRep_Health</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldHealth)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">GAMEPLAYATTRIBUTE_REPNOTIFY</span>(UMyAttributeSet, Health, OldHealth);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UMyAttributeSet::OnRep_MaxHealth</span><span class="params">(<span class="type">const</span> FGameplayAttributeData&amp; OldMaxHealth)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">GAMEPLAYATTRIBUTE_REPNOTIFY</span>(UMyAttributeSet, MaxHealth, OldMaxHealth);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="PlayerState配置"><a href="#PlayerState配置" class="headerlink" title="PlayerState配置"></a>PlayerState配置</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CoreMinimal.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AbilitySystemInterface.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;GameFramework/PlayerState.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AuraPlayerState.generated.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UAbilitySystemComponent</span>;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UAttributeSet</span>;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="built_in">UCLASS</span>()</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">GASDEMO_API</span> AAuraPlayerState : <span class="keyword">public</span> APlayerState,<span class="keyword">public</span> IAbilitySystemInterface</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_BODY</span>()</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">AAuraPlayerState</span>();</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> UAbilitySystemComponent* <span class="title">GetAbilitySystemComponent</span><span class="params">()</span> <span class="type">const</span> <span class="keyword">override</span></span>;</span><br><span class="line">	<span class="function">UAttributeSet* <span class="title">GetAttributeSet</span><span class="params">()</span> <span class="type">const</span> </span>&#123; <span class="keyword">return</span> AttributeSet; &#125;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">UPROPERTY</span>()</span><br><span class="line">	<span class="comment">//指向UAbilitySystemComponent的智能指针，用于管理玩家的能力和效果。</span></span><br><span class="line">	TObjectPtr&lt;UAbilitySystemComponent&gt; AbilitySystemComponent;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>()</span><br><span class="line">	<span class="comment">//指向UAttributeSet的智能指针，用于存储玩家的属性值，如生命值、魔法值等</span></span><br><span class="line">	TObjectPtr&lt;UAttributeSet&gt; AttributeSet;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Player/AuraPlayerState.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AbilitySystem/AuraAbilitySystemComponent.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AbilitySystem/AuraAttributeSet.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">AAuraPlayerState::<span class="built_in">AAuraPlayerState</span>()</span><br><span class="line">&#123;</span><br><span class="line">	AbilitySystemComponent = <span class="built_in">CreateDefaultSubobject</span>&lt;UAuraAbilitySystemComponent&gt;(<span class="string">&quot;AbilitySystemComponent&quot;</span>);</span><br><span class="line">	AbilitySystemComponent-&gt;<span class="built_in">SetIsReplicated</span>(<span class="literal">true</span>);</span><br><span class="line">	AbilitySystemComponent-&gt;<span class="built_in">SetReplicationMode</span>(EGameplayEffectReplicationMode::Mixed);</span><br><span class="line"></span><br><span class="line">	AttributeSet = <span class="built_in">CreateDefaultSubobject</span>&lt;UAuraAttributeSet&gt;(<span class="string">&quot;AttributeSet&quot;</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//这段C++代码是Unreal Engine中的一部分，用于设置一个玩家状态(AAuraPlayerState)的网络更新频率</span></span><br><span class="line">	NetUpdateFrequency=<span class="number">100.f</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//接口继承的方法，返回AbilitySystemComponent</span></span><br><span class="line"><span class="function">UAbilitySystemComponent* <span class="title">AAuraPlayerState::GetAbilitySystemComponent</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> AbilitySystemComponent;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="玩家配置"><a href="#玩家配置" class="headerlink" title="玩家配置"></a>玩家配置</h3><ul>
<li>基类</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CoreMinimal.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;GameFramework/Character.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AbilitySystemInterface.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AuraCharacterBase.generated.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UAbilitySystemComponent</span>;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UAttributeSet</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">UCLASS</span>()</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AURADEMO_API</span> AAuraCharacterBase : <span class="keyword">public</span> ACharacter,<span class="keyword">public</span> IAbilitySystemInterface</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_BODY</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">AAuraCharacterBase</span>();</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> UAbilitySystemComponent* <span class="title">GetAbilitySystemComponent</span><span class="params">()</span> <span class="type">const</span> <span class="keyword">override</span></span>;</span><br><span class="line">	<span class="function">UAttributeSet* <span class="title">GetAttributeSet</span><span class="params">()</span> <span class="type">const</span> </span>&#123; <span class="keyword">return</span> AttributeSet; &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">BeginPlay</span><span class="params">()</span> <span class="keyword">override</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*UAbilitySystemComponent对象*/</span></span><br><span class="line">	<span class="built_in">UPROPERTY</span>()</span><br><span class="line">	TObjectPtr&lt;UAbilitySystemComponent&gt; AbilitySystemComponent;</span><br><span class="line">	<span class="comment">/*UAttributeSet对象*/</span></span><br><span class="line">	<span class="built_in">UPROPERTY</span>()</span><br><span class="line">	TObjectPtr&lt;UAttributeSet&gt; AttributeSet;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">UAbilitySystemComponent* <span class="title">AAuraCharacterBase::GetAbilitySystemComponent</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> AbilitySystemComponent;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>子类</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CoreMinimal.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AuraCharacterBase.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AuraCharacter.generated.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="built_in">UCLASS</span>()</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AURADEMO_API</span> AAuraCharacter : <span class="keyword">public</span> AAuraCharacterBase</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_BODY</span>()</span><br><span class="line"><span class="keyword">public</span>:	</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span>  <span class="type">void</span> <span class="title">PossessedBy</span><span class="params">(AController* NewController)</span> <span class="keyword">override</span></span>;</span><br><span class="line">	<span class="comment">//网络同步相关</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">OnRep_PlayerState</span><span class="params">()</span> <span class="keyword">override</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">InitAbilityActorInfo</span><span class="params">()</span></span>;</span><br><span class="line">	</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Character/AuraCharacter.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AbilitySystem/AuraAbilitySystemComponent.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Player/AuraPlayerState.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AAuraCharacter::PossessedBy</span><span class="params">(AController* NewController)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Super::<span class="built_in">PossessedBy</span>(NewController);</span><br><span class="line">	<span class="built_in">InitAbilityActorInfo</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AAuraCharacter::OnRep_PlayerState</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Super::<span class="built_in">OnRep_PlayerState</span>();</span><br><span class="line">	<span class="built_in">InitAbilityActorInfo</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AAuraCharacter::InitAbilityActorInfo</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">/*初始化玩家角色能力系统和属性*/</span></span><br><span class="line">	AAuraPlayerState* AuraPlayerState = <span class="built_in">GetPlayerState</span>&lt;AAuraPlayerState&gt;();</span><br><span class="line">	<span class="built_in">check</span>(AuraPlayerState);</span><br><span class="line">    <span class="comment">//玩家状态对玩家角色施加?</span></span><br><span class="line">	AuraPlayerState-&gt;<span class="built_in">GetAbilitySystemComponent</span>()-&gt;<span class="built_in">InitAbilityActorInfo</span>(AuraPlayerState, <span class="keyword">this</span>); <span class="comment">//如果是怪物则AuraPlayerState改为this</span></span><br><span class="line">	<span class="built_in">Cast</span>&lt;UAuraAbilitySystemComponent&gt;(AuraPlayerState-&gt;<span class="built_in">GetAbilitySystemComponent</span>())-&gt;<span class="built_in">AbilityActorInfoSet</span>();<span class="comment">//绑定委托,未实现</span></span><br><span class="line">	AbilitySystemComponent = AuraPlayerState-&gt;<span class="built_in">GetAbilitySystemComponent</span>();</span><br><span class="line">	AttributeSet = AuraPlayerState-&gt;<span class="built_in">GetAttributeSet</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="添加和删除"><a href="#添加和删除" class="headerlink" title="添加和删除"></a>添加和删除</h3><ul>
<li>添加</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">AbilitySystemComponent-&gt;SpawnedAttributes.<span class="built_in">AddUnique</span>(WeaponAttributeSetPointer);</span><br><span class="line">AbilitySystemComponent-&gt;<span class="built_in">ForceReplication</span>();</span><br></pre></td></tr></table></figure>

<ul>
<li>删除</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">AbilitySystemComponent-&gt;SpawnedAttributes.<span class="built_in">Remove</span>(WeaponAttributeSetPointer);</span><br><span class="line">AbilitySystemComponent-&gt;<span class="built_in">ForceReplication</span>();</span><br></pre></td></tr></table></figure>

<h2 id="能力（Ability）"><a href="#能力（Ability）" class="headerlink" title="能力（Ability）"></a>能力（Ability）</h2><h3 id="GA一般要做的事"><a href="#GA一般要做的事" class="headerlink" title="GA一般要做的事"></a>GA一般要做的事</h3><ul>
<li><p>设置GA的Tag、CD、Cost等属性。</p>
</li>
<li><p>获取必要信息，主要通过Get Actor Info。如果是通过Event调用的GA（使用Activate Ability From Event节点作为输入），还可以通过Gameplay Event Data获取。</p>
</li>
<li><p>编写逻辑，如播放动画、应用GE、应用冲量等。</p>
</li>
<li><p>一定不要忘了EndAbility。</p>
<h3 id="标签（Tags）"><a href="#标签（Tags）" class="headerlink" title="标签（Tags）"></a>标签（Tags）</h3><ul>
<li>能力标签（Ability Tags）</li>
<li>取消带标签的能力（Cancel abilities with tag）</li>
<li>锁定带标签的能力（vlock [应为“lock”的误写] abilities with tag）</li>
<li>激活拥有的标签（activation owned tags）</li>
<li>激活被阻止的标签（activation blocked tags）</li>
<li>源所需标签（source required tags）</li>
<li>源被阻止的标签（source blocked tags）</li>
<li>目标所需标签（target required tags）</li>
<li>目标被阻止的标签（target blocked tags）</li>
</ul>
<h3 id="输入（Input）"><a href="#输入（Input）" class="headerlink" title="输入（Input）"></a>输入（Input）</h3><ul>
<li>直接复制输入（Replicate Input Directly）</li>
</ul>
<h3 id="高级（Advanced）"><a href="#高级（Advanced）" class="headerlink" title="高级（Advanced）"></a>高级（Advanced）</h3><ul>
<li>复制策略（ReplicationPolicy）</li>
<li>实例化策略（Instancing Policy）</li>
<li>服务器尊重远程能力取消（Server Respects Remote Ability Cancellation）</li>
<li>重新触发实例化能力（Retrigger Instanced Ability）</li>
<li>网络执行策略（Net Execution Policy）</li>
<li>网络安全策略（Net Security Policy）</li>
</ul>
<h3 id="成本（Costs）"><a href="#成本（Costs）" class="headerlink" title="成本（Costs）"></a>成本（Costs）</h3><ul>
<li>成本游戏效果类（Cost Gameplay Effect Class）</li>
</ul>
<h3 id="触发器（Triggers）"><a href="#触发器（Triggers）" class="headerlink" title="触发器（Triggers）"></a>触发器（Triggers）</h3><ul>
<li>能力触发器（Ability Triggers）</li>
</ul>
<h3 id="冷却时间（Cooldowns）"><a href="#冷却时间（Cooldowns）" class="headerlink" title="冷却时间（Cooldowns）"></a>冷却时间（Cooldowns）</h3><ul>
<li>冷却时间游戏效果类（Cooldown Gameplay Effect Class）</li>
</ul>
</li>
</ul>
<h4 id="申请GE实现扣血"><a href="#申请GE实现扣血" class="headerlink" title="申请GE实现扣血"></a>申请GE实现扣血</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">applygameplayeffecttoowner</span><br><span class="line">    playmontageandwai</span><br></pre></td></tr></table></figure>



<h2 id="GE"><a href="#GE" class="headerlink" title="GE"></a>GE</h2><ul>
<li>编辑器状态文本 (Editor Status Text)</li>
<li>持续时间 (Duration)<ul>
<li>Instant 立即生效</li>
<li>Infinite 永久生效</li>
<li>Period 周期内生效</li>
</ul>
</li>
<li>游戏效果 (Gameplay Effect)<ul>
<li>组件 (Components)</li>
<li>修饰符 (Modifiers)</li>
<li>执行 (Executions)</li>
</ul>
</li>
<li>游戏提示 (Gameplay Cues)<ul>
<li>Require Modifier Success to Trigger Cues 需要修饰符成功才能触发提示</li>
<li>Suppress Stacking Cues 抑制叠加提示</li>
<li>Gameplay Cues 游戏提示</li>
</ul>
</li>
<li>叠加 (Stacking)<ul>
<li>Stacking Type 叠加类型</li>
</ul>
</li>
</ul>
<h1 id="蓝图文件夹"><a href="#蓝图文件夹" class="headerlink" title="蓝图文件夹"></a>蓝图文件夹</h1><h2 id="AbilitySystem-能力系统"><a href="#AbilitySystem-能力系统" class="headerlink" title="AbilitySystem 能力系统"></a>AbilitySystem 能力系统</h2><ul>
<li>定义能力系统,包括GE,GA,GC和属性数据</li>
</ul>
<h3 id="Aura"><a href="#Aura" class="headerlink" title="Aura"></a>Aura</h3><ul>
<li>Abilities 能力  里边的蓝图好像是魔法阵的</li>
<li>Effects 效果 用于初始化数据的GE类</li>
</ul>
<h3 id="data-数据表格和数据资产"><a href="#data-数据表格和数据资产" class="headerlink" title="data 数据表格和数据资产"></a>data 数据表格和数据资产</h3><h4 id="Enemy-怪物的技能和能力"><a href="#Enemy-怪物的技能和能力" class="headerlink" title="Enemy 怪物的技能和能力"></a>Enemy 怪物的技能和能力</h4><h4 id="GameplayCueNotifies-特效和音效等"><a href="#GameplayCueNotifies-特效和音效等" class="headerlink" title="GameplayCueNotifies 特效和音效等"></a>GameplayCueNotifies 特效和音效等</h4><h4 id="GameplayTags-游戏标签数据表"><a href="#GameplayTags-游戏标签数据表" class="headerlink" title="GameplayTags 游戏标签数据表"></a>GameplayTags 游戏标签数据表</h4><h2 id="Actor-演员-用于当玩家碰撞物品时将效果应用到玩家身上"><a href="#Actor-演员-用于当玩家碰撞物品时将效果应用到玩家身上" class="headerlink" title="Actor 演员(用于当玩家碰撞物品时将效果应用到玩家身上)"></a>Actor 演员(用于当玩家碰撞物品时将效果应用到玩家身上)</h2><h4 id="Area-地火演员和GE"><a href="#Area-地火演员和GE" class="headerlink" title="Area 地火演员和GE"></a>Area 地火演员和GE</h4><h4 id="Crystal-水晶"><a href="#Crystal-水晶" class="headerlink" title="Crystal 水晶"></a>Crystal 水晶</h4><h4 id="FadeActor-建筑蓝图-继承接口-识别可点击点"><a href="#FadeActor-建筑蓝图-继承接口-识别可点击点" class="headerlink" title="FadeActor 建筑蓝图,继承接口,识别可点击点?"></a>FadeActor 建筑蓝图,继承接口,识别可点击点?</h4><h4 id="FlamePillar-火焰柱"><a href="#FlamePillar-火焰柱" class="headerlink" title="FlamePillar 火焰柱"></a>FlamePillar 火焰柱</h4><h4 id="Potion-药水"><a href="#Potion-药水" class="headerlink" title="Potion 药水"></a>Potion 药水</h4><h4 id="Test-Actor-测试的演员"><a href="#Test-Actor-测试的演员" class="headerlink" title="Test Actor 测试的演员"></a>Test Actor 测试的演员</h4><h2 id="AI"><a href="#AI" class="headerlink" title="AI"></a>AI</h2><h2 id="AnimNotifies-动画通知"><a href="#AnimNotifies-动画通知" class="headerlink" title="AnimNotifies 动画通知"></a>AnimNotifies 动画通知</h2><h2 id="Character-角色-除了玩家怪物都没用蓝图节点"><a href="#Character-角色-除了玩家怪物都没用蓝图节点" class="headerlink" title="Character  角色  (除了玩家怪物都没用蓝图节点)"></a>Character  角色  (除了玩家怪物都没用蓝图节点)</h2><h2 id="Checkpoint-检查点-用了蓝图"><a href="#Checkpoint-检查点-用了蓝图" class="headerlink" title="Checkpoint 检查点 (用了蓝图)"></a>Checkpoint 检查点 (用了蓝图)</h2><h2 id="Game-游戏-游戏单例类-包含存储"><a href="#Game-游戏-游戏单例类-包含存储" class="headerlink" title="Game 游戏 (游戏单例类,包含存储)"></a>Game 游戏 (游戏单例类,包含存储)</h2><h2 id="Input-输入-输入映射配置"><a href="#Input-输入-输入映射配置" class="headerlink" title="Input 输入 (输入映射配置)"></a>Input 输入 (输入映射配置)</h2><h2 id="MainMenu-主菜单-开始界面"><a href="#MainMenu-主菜单-开始界面" class="headerlink" title="MainMenu 主菜单 (开始界面)"></a>MainMenu 主菜单 (开始界面)</h2><h2 id="Player-玩家-玩家控制器和玩家状态蓝图"><a href="#Player-玩家-玩家控制器和玩家状态蓝图" class="headerlink" title="Player 玩家 (玩家控制器和玩家状态蓝图)"></a>Player 玩家 (玩家控制器和玩家状态蓝图)</h2><h2 id="SpawnVolumes-产卵量"><a href="#SpawnVolumes-产卵量" class="headerlink" title="SpawnVolumes 产卵量"></a>SpawnVolumes 产卵量</h2><h2 id="UI-界面"><a href="#UI-界面" class="headerlink" title="UI 界面"></a>UI 界面</h2><h4 id="data-数据表"><a href="#data-数据表" class="headerlink" title="data 数据表"></a>data 数据表</h4><h4 id="HUD-1"><a href="#HUD-1" class="headerlink" title="HUD"></a>HUD</h4><h4 id="ViewModel-数据模型"><a href="#ViewModel-数据模型" class="headerlink" title="ViewModel 数据模型"></a>ViewModel 数据模型</h4><h4 id="WidgetController-小部件控制器-继承者UObject"><a href="#WidgetController-小部件控制器-继承者UObject" class="headerlink" title="WidgetController 小部件控制器 继承者UObject"></a>WidgetController 小部件控制器 继承者UObject</h4></article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="/img/touxiang.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="/img/touxiang.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">凝雨</div><div class="post-copyright__author_desc">人生得意须尽欢，莫使金樽空对月。</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="http://example.com/2024/03/30/ue5/%E5%8F%98%E9%87%8F/AGS%E8%AF%BE%E7%A8%8B/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('http://example.com/2024/03/30/ue5/%E5%8F%98%E9%87%8F/AGS%E8%AF%BE%E7%A8%8B/')">AGS课程笔记</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="赞赏作者"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>打赏作者</div><div class="reward-main"><div class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a href="/img/ds.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="/img/ds.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/ds.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="/img/ds.png" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">赞赏者名单</div><div class="reward-dec">因为你们的支持让我意识到写文章的价值🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="http://example.com/2024/03/30/ue5/%E5%8F%98%E9%87%8F/AGS%E8%AF%BE%E7%A8%8B/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=AGS课程笔记&amp;url=http://example.com/2024/03/30/ue5/%E5%8F%98%E9%87%8F/AGS%E8%AF%BE%E7%A8%8B/&amp;pic=/img/ww/D004.png" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__category-list"><a class="post-meta__box__categoryes" href="/categories/ue5/"><span class="categoryes-punctuation"> <i class="anzhiyufont anzhiyu-icon-inbox"></i></span>ue5<span class="categoryesPageCount">8</span></a></div><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/%E5%AD%A6%E4%B9%A0/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>学习<span class="tagsPageCount">35</span></a><a class="post-meta__box__tags" href="/tags/%E5%8F%98%E9%87%8F/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>变量<span class="tagsPageCount">5</span></a></div></div><div class="post_share"><div class="social-share" data-image="https://vfiles.gtimg.cn/xy_open/wupload/xy/dnf_universe_app/2RSwZFEA.jpg?_r_=b10ef413-c7e0-ef53-eeda-7eafc76e161c" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/03/30/ue5/%E5%8F%98%E9%87%8F/GAS%E7%B3%BB%E7%BB%9F/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="https://files.wujicode.cn/w/open/dnf_universe_app/PklBdp0O.jpg?_r_=ff80767b-b708-2b60-541e-c16868fa6bd4" onerror="onerror=null;src='https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">Gas系统笔记</div></div></a></div><div class="next-post pull-right"><a href="/2024/03/30/ue5/%E5%8F%98%E9%87%8F/API/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="https://files.wujicode.cn/w/open/dnf_universe_app/GlsLtlEo.jpg?_r_=3dc499da-5383-4e8d-6b78-456800c6d6f0" onerror="onerror=null;src='https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">ue5API</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2024/03/30/unity/%E6%80%AA%E7%89%A9%E8%B7%9F%E8%B8%AA%E7%8E%A9%E5%AE%B6/" title="怪物追玩家"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="https://files.wujicode.cn/w/open/dnf_universe_app/6ji052de.jpg?_r_=eaeb1dd4-8ee6-c628-8bb9-d3bffba1a68a" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-03-30</div><div class="title">怪物追玩家</div></div></a></div><div><a href="/2024/03/30/ue5/%E5%8F%98%E9%87%8F/API/" title="ue5API"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="https://files.wujicode.cn/w/open/dnf_universe_app/GlsLtlEo.jpg?_r_=3dc499da-5383-4e8d-6b78-456800c6d6f0" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-03-30</div><div class="title">ue5API</div></div></a></div><div><a href="/2024/03/30/ue5/%E5%8F%98%E9%87%8F/GAS%E7%B3%BB%E7%BB%9F/" title="Gas系统笔记"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="https://files.wujicode.cn/w/open/dnf_universe_app/PklBdp0O.jpg?_r_=ff80767b-b708-2b60-541e-c16868fa6bd4" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-03-30</div><div class="title">Gas系统笔记</div></div></a></div><div><a href="/2024/03/30/ue5/%E5%8F%98%E9%87%8F/%E6%A8%A1%E6%9D%BF/" title="ue5模板"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="https://files.wujicode.cn/w/open/dnf_universe_app/GlsLtlEo.jpg?_r_=5f5522d9-26f3-9b25-dec8-42b3be407bf4" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-03-30</div><div class="title">ue5模板</div></div></a></div><div><a href="/2025/03/15/cpp/C++%E6%95%B0%E7%BB%84/" title="c++数组"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="https://vfiles.gtimg.cn/xy_open/wupload/xy/dnf_universe_app/2RSwZFEA.jpg?_r_=aa36e58f-17fd-6230-563e-f8eb1208f464" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-03-15</div><div class="title">c++数组</div></div></a></div><div><a href="/2025/03/15/cpp/CMake/" title="Cmake"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="https://files.wujicode.cn/w/open/dnf_universe_app/GlsLtlEo.jpg?_r_=2e6991ab-fd14-f83e-69d5-664530611c8d" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-03-15</div><div class="title">Cmake</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> Comment</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)">匿名评论</a><a href="/privacy" style="margin-left: 4px">隐私政策</a></div><div class="comment-switch"><span class="first-comment">Twikoo</span><span id="switch-btn"></span><span class="second-comment">Waline</span></div><div class="comment-tips" id="comment-tips"><span>✅ 你无需删除空行，直接评论以获取最佳展示效果</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div><div><div id="waline-wrap"></div></div></div></div><div class="comment-barrage"></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="/img/touxiang.jpg" onerror="this.onerror=null;this.src='https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg'" alt="avatar"/><div class="author-status"><img class="g-status" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="https://bu.dusays.com/2023/08/24/64e6ce9c507bb.png" alt="status"/></div></div><div class="author-info__description"><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">这有关于<b style="color:#fff">产品、设计、开发</b>相关的问题和看法，还有<b style="color:#fff">文章翻译</b>和<b style="color:#fff">分享</b>。</div><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">相信你可以在这里找到对你有用的<b style="color:#fff">知识</b>和<b style="color:#fff">教程</b>。</div></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/"><h1 class="author-info__name">凝雨</h1><div class="author-info__desc">人生得意须尽欢，莫使金樽空对月。</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/Luojiangbao015" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="social-icon faa-parent animated-hover" href="https://space.bilibili.com/253251579" target="_blank" title="BiliBili"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a></div></div></div></div><div class="card-widget anzhiyu-right-widget" id="card-wechat" onclick="null"><div id="flip-wrapper"><div id="flip-content"><div class="face" style="background: url(https://bu.dusays.com/2023/01/13/63c02edf44033.png) center center / 100% no-repeat"></div><div class="back face" style="background: url(https://bu.dusays.com/2023/05/13/645fa415e8694.png) center center / 100% no-repeat"></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E7%AB%A0-%E6%B7%BB%E5%8A%A0%E7%8E%A9%E5%AE%B6%E8%A7%92%E8%89%B2%E5%B9%B6%E6%8E%A7%E5%88%B6"><span class="toc-number">1.</span> <span class="toc-text">第一章:添加玩家角色并控制</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E8%8A%82-%E6%B7%BB%E5%8A%A0CPP%E5%9F%BA%E7%B1%BB"><span class="toc-number">1.1.</span> <span class="toc-text">第一节:添加CPP基类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E8%8A%82-%E8%A7%92%E8%89%B2%E5%8A%A8%E7%94%BB%E5%92%8C%E8%A3%85%E5%A4%87%E6%AD%A6%E5%99%A8"><span class="toc-number">1.2.</span> <span class="toc-text">第二节:角色动画和装备武器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E8%8A%82-%E8%A7%92%E8%89%B2%E7%8A%B6%E6%80%81%E6%9C%BA%E5%92%8C%E5%8A%A8%E7%94%BB"><span class="toc-number">1.3.</span> <span class="toc-text">第三节 :角色状态机和动画</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%9B%9B%E8%8A%82-%E6%80%AA%E7%89%A9%E5%8A%A8%E7%94%BB"><span class="toc-number">1.4.</span> <span class="toc-text">第四节:怪物动画</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%94%E8%8A%82-%E5%A2%9E%E5%BC%BA%E8%BE%93%E5%85%A5%E7%B3%BB%E7%BB%9F"><span class="toc-number">1.5.</span> <span class="toc-text">第五节:增强输入系统</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%85%AD%E8%8A%82-%E6%B7%BB%E5%8A%A0%E7%9B%B8%E6%9C%BA%E5%8F%8A%E8%AE%BE%E7%BD%AE%E8%A7%92%E8%89%B2%E9%80%89%E6%8B%A9"><span class="toc-number">1.6.</span> <span class="toc-text">第六节:添加相机及设置角色选择</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E7%AB%A0"><span class="toc-number">2.</span> <span class="toc-text">第二章</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E8%8A%82-%E6%B7%BB%E5%8A%A0%E6%8E%A5%E5%8F%A3"><span class="toc-number">2.1.</span> <span class="toc-text">第一节:添加接口</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#UI"><span class="toc-number">3.</span> <span class="toc-text">UI</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E8%A1%80%E9%87%8FUI"><span class="toc-number">3.1.</span> <span class="toc-text">创建血量UI</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81"><span class="toc-number">3.2.</span> <span class="toc-text">代码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E6%8E%A7%E4%BB%B6%E5%9F%BA%E7%B1%BB"><span class="toc-number">3.2.1.</span> <span class="toc-text">用户控件基类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A7%E5%88%B6%E5%99%A8"><span class="toc-number">3.2.2.</span> <span class="toc-text">控制器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A7%E5%88%B6%E5%99%A8%E5%AD%90%E7%B1%BB"><span class="toc-number">3.2.3.</span> <span class="toc-text">控制器子类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HUD"><span class="toc-number">3.2.4.</span> <span class="toc-text">HUD</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AuraCharacter-cpp-%E4%B8%BA%E5%88%9D%E5%A7%8B%E5%8C%96%E7%9A%84%E5%9C%B0%E6%96%B9"><span class="toc-number">3.2.5.</span> <span class="toc-text">AuraCharacter.cpp*********************************************为初始化的地方</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%85%8D%E7%BD%AEGAS"><span class="toc-number">4.</span> <span class="toc-text">配置GAS</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E8%8A%82-%E6%B7%BB%E5%8A%A0CPP%E7%B1%BB%E5%92%8C%E5%A3%B0%E6%98%8E"><span class="toc-number">4.1.</span> <span class="toc-text">第一节:添加CPP类和声明</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E8%8A%82-%E5%88%9B%E5%BB%BA%E5%AE%9E%E4%BE%8B"><span class="toc-number">4.2.</span> <span class="toc-text">第二节:创建实例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E8%8A%82-%E5%A4%84%E7%90%86%E7%BD%91%E7%BB%9C%E5%90%8C%E6%AD%A5-%E5%A6%82%E4%B8%8A%E6%B3%A8%E9%87%8A"><span class="toc-number">4.3.</span> <span class="toc-text">第三节:处理网络同步,如上注释</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%9B%9B%E8%8A%82-%E5%B1%9E%E6%80%A7%E5%A3%B0%E6%98%8E"><span class="toc-number">4.4.</span> <span class="toc-text">第四节:属性声明</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE"><span class="toc-number">5.</span> <span class="toc-text">项目</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E6%96%87%E4%BB%B6%E5%A4%B9"><span class="toc-number">5.1.</span> <span class="toc-text">代码文件夹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Ability-System"><span class="toc-number">5.2.</span> <span class="toc-text">Ability System</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UI-MVC%E6%9E%B6%E6%9E%84"><span class="toc-number">5.3.</span> <span class="toc-text">UI MVC架构</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%B1%BB"><span class="toc-number">6.</span> <span class="toc-text">类</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Ability-System-%E6%8A%80%E8%83%BD%E7%AE%A1%E7%90%86"><span class="toc-number">6.1.</span> <span class="toc-text">Ability System 技能管理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Actor-%E6%8A%80%E8%83%BD%E5%AE%9E%E4%BE%8B"><span class="toc-number">6.2.</span> <span class="toc-text">Actor 技能实例</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%93%9D%E5%9B%BE"><span class="toc-number">7.</span> <span class="toc-text">蓝图</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ACS%E9%85%8D%E7%BD%AE"><span class="toc-number">7.1.</span> <span class="toc-text">ACS配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7%E9%85%8D%E7%BD%AE"><span class="toc-number">7.2.</span> <span class="toc-text">属性配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#UAttributeSet%E9%85%8D%E7%BD%AE"><span class="toc-number">7.2.1.</span> <span class="toc-text">UAttributeSet配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PlayerState%E9%85%8D%E7%BD%AE"><span class="toc-number">7.2.2.</span> <span class="toc-text">PlayerState配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8E%A9%E5%AE%B6%E9%85%8D%E7%BD%AE"><span class="toc-number">7.2.3.</span> <span class="toc-text">玩家配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E5%92%8C%E5%88%A0%E9%99%A4"><span class="toc-number">7.2.4.</span> <span class="toc-text">添加和删除</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%83%BD%E5%8A%9B%EF%BC%88Ability%EF%BC%89"><span class="toc-number">7.3.</span> <span class="toc-text">能力（Ability）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#GA%E4%B8%80%E8%88%AC%E8%A6%81%E5%81%9A%E7%9A%84%E4%BA%8B"><span class="toc-number">7.3.1.</span> <span class="toc-text">GA一般要做的事</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%87%E7%AD%BE%EF%BC%88Tags%EF%BC%89"><span class="toc-number">7.3.2.</span> <span class="toc-text">标签（Tags）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BE%93%E5%85%A5%EF%BC%88Input%EF%BC%89"><span class="toc-number">7.3.3.</span> <span class="toc-text">输入（Input）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AB%98%E7%BA%A7%EF%BC%88Advanced%EF%BC%89"><span class="toc-number">7.3.4.</span> <span class="toc-text">高级（Advanced）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%88%90%E6%9C%AC%EF%BC%88Costs%EF%BC%89"><span class="toc-number">7.3.5.</span> <span class="toc-text">成本（Costs）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A6%E5%8F%91%E5%99%A8%EF%BC%88Triggers%EF%BC%89"><span class="toc-number">7.3.6.</span> <span class="toc-text">触发器（Triggers）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%B7%E5%8D%B4%E6%97%B6%E9%97%B4%EF%BC%88Cooldowns%EF%BC%89"><span class="toc-number">7.3.7.</span> <span class="toc-text">冷却时间（Cooldowns）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%B3%E8%AF%B7GE%E5%AE%9E%E7%8E%B0%E6%89%A3%E8%A1%80"><span class="toc-number">7.3.7.1.</span> <span class="toc-text">申请GE实现扣血</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GE"><span class="toc-number">7.4.</span> <span class="toc-text">GE</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%93%9D%E5%9B%BE%E6%96%87%E4%BB%B6%E5%A4%B9"><span class="toc-number">8.</span> <span class="toc-text">蓝图文件夹</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#AbilitySystem-%E8%83%BD%E5%8A%9B%E7%B3%BB%E7%BB%9F"><span class="toc-number">8.1.</span> <span class="toc-text">AbilitySystem 能力系统</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Aura"><span class="toc-number">8.1.1.</span> <span class="toc-text">Aura</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#data-%E6%95%B0%E6%8D%AE%E8%A1%A8%E6%A0%BC%E5%92%8C%E6%95%B0%E6%8D%AE%E8%B5%84%E4%BA%A7"><span class="toc-number">8.1.2.</span> <span class="toc-text">data 数据表格和数据资产</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Enemy-%E6%80%AA%E7%89%A9%E7%9A%84%E6%8A%80%E8%83%BD%E5%92%8C%E8%83%BD%E5%8A%9B"><span class="toc-number">8.1.2.1.</span> <span class="toc-text">Enemy 怪物的技能和能力</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#GameplayCueNotifies-%E7%89%B9%E6%95%88%E5%92%8C%E9%9F%B3%E6%95%88%E7%AD%89"><span class="toc-number">8.1.2.2.</span> <span class="toc-text">GameplayCueNotifies 特效和音效等</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#GameplayTags-%E6%B8%B8%E6%88%8F%E6%A0%87%E7%AD%BE%E6%95%B0%E6%8D%AE%E8%A1%A8"><span class="toc-number">8.1.2.3.</span> <span class="toc-text">GameplayTags 游戏标签数据表</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Actor-%E6%BC%94%E5%91%98-%E7%94%A8%E4%BA%8E%E5%BD%93%E7%8E%A9%E5%AE%B6%E7%A2%B0%E6%92%9E%E7%89%A9%E5%93%81%E6%97%B6%E5%B0%86%E6%95%88%E6%9E%9C%E5%BA%94%E7%94%A8%E5%88%B0%E7%8E%A9%E5%AE%B6%E8%BA%AB%E4%B8%8A"><span class="toc-number">8.2.</span> <span class="toc-text">Actor 演员(用于当玩家碰撞物品时将效果应用到玩家身上)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Area-%E5%9C%B0%E7%81%AB%E6%BC%94%E5%91%98%E5%92%8CGE"><span class="toc-number">8.2.0.1.</span> <span class="toc-text">Area 地火演员和GE</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Crystal-%E6%B0%B4%E6%99%B6"><span class="toc-number">8.2.0.2.</span> <span class="toc-text">Crystal 水晶</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#FadeActor-%E5%BB%BA%E7%AD%91%E8%93%9D%E5%9B%BE-%E7%BB%A7%E6%89%BF%E6%8E%A5%E5%8F%A3-%E8%AF%86%E5%88%AB%E5%8F%AF%E7%82%B9%E5%87%BB%E7%82%B9"><span class="toc-number">8.2.0.3.</span> <span class="toc-text">FadeActor 建筑蓝图,继承接口,识别可点击点?</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#FlamePillar-%E7%81%AB%E7%84%B0%E6%9F%B1"><span class="toc-number">8.2.0.4.</span> <span class="toc-text">FlamePillar 火焰柱</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Potion-%E8%8D%AF%E6%B0%B4"><span class="toc-number">8.2.0.5.</span> <span class="toc-text">Potion 药水</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Test-Actor-%E6%B5%8B%E8%AF%95%E7%9A%84%E6%BC%94%E5%91%98"><span class="toc-number">8.2.0.6.</span> <span class="toc-text">Test Actor 测试的演员</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AI"><span class="toc-number">8.3.</span> <span class="toc-text">AI</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AnimNotifies-%E5%8A%A8%E7%94%BB%E9%80%9A%E7%9F%A5"><span class="toc-number">8.4.</span> <span class="toc-text">AnimNotifies 动画通知</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Character-%E8%A7%92%E8%89%B2-%E9%99%A4%E4%BA%86%E7%8E%A9%E5%AE%B6%E6%80%AA%E7%89%A9%E9%83%BD%E6%B2%A1%E7%94%A8%E8%93%9D%E5%9B%BE%E8%8A%82%E7%82%B9"><span class="toc-number">8.5.</span> <span class="toc-text">Character  角色  (除了玩家怪物都没用蓝图节点)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Checkpoint-%E6%A3%80%E6%9F%A5%E7%82%B9-%E7%94%A8%E4%BA%86%E8%93%9D%E5%9B%BE"><span class="toc-number">8.6.</span> <span class="toc-text">Checkpoint 检查点 (用了蓝图)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Game-%E6%B8%B8%E6%88%8F-%E6%B8%B8%E6%88%8F%E5%8D%95%E4%BE%8B%E7%B1%BB-%E5%8C%85%E5%90%AB%E5%AD%98%E5%82%A8"><span class="toc-number">8.7.</span> <span class="toc-text">Game 游戏 (游戏单例类,包含存储)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Input-%E8%BE%93%E5%85%A5-%E8%BE%93%E5%85%A5%E6%98%A0%E5%B0%84%E9%85%8D%E7%BD%AE"><span class="toc-number">8.8.</span> <span class="toc-text">Input 输入 (输入映射配置)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MainMenu-%E4%B8%BB%E8%8F%9C%E5%8D%95-%E5%BC%80%E5%A7%8B%E7%95%8C%E9%9D%A2"><span class="toc-number">8.9.</span> <span class="toc-text">MainMenu 主菜单 (开始界面)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Player-%E7%8E%A9%E5%AE%B6-%E7%8E%A9%E5%AE%B6%E6%8E%A7%E5%88%B6%E5%99%A8%E5%92%8C%E7%8E%A9%E5%AE%B6%E7%8A%B6%E6%80%81%E8%93%9D%E5%9B%BE"><span class="toc-number">8.10.</span> <span class="toc-text">Player 玩家 (玩家控制器和玩家状态蓝图)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SpawnVolumes-%E4%BA%A7%E5%8D%B5%E9%87%8F"><span class="toc-number">8.11.</span> <span class="toc-text">SpawnVolumes 产卵量</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UI-%E7%95%8C%E9%9D%A2"><span class="toc-number">8.12.</span> <span class="toc-text">UI 界面</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#data-%E6%95%B0%E6%8D%AE%E8%A1%A8"><span class="toc-number">8.12.0.1.</span> <span class="toc-text">data 数据表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HUD-1"><span class="toc-number">8.12.0.2.</span> <span class="toc-text">HUD</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ViewModel-%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B"><span class="toc-number">8.12.0.3.</span> <span class="toc-text">ViewModel 数据模型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WidgetController-%E5%B0%8F%E9%83%A8%E4%BB%B6%E6%8E%A7%E5%88%B6%E5%99%A8-%E7%BB%A7%E6%89%BF%E8%80%85UObject"><span class="toc-number">8.12.0.4.</span> <span class="toc-text">WidgetController 小部件控制器 继承者UObject</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/03/15/%E6%B8%B8%E6%88%8F%E8%AE%BE%E8%AE%A1/%E6%B8%B8%E6%88%8F%E8%AE%BE%E8%AE%A1/" title="游戏设计"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="https://vfiles.gtimg.cn/xy_open/wupload/xy/dnf_universe_app/2RSwZFEA.jpg?_r_=b10ef413-c7e0-ef53-eeda-7eafc76e161c" onerror="this.onerror=null;this.src='https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg'" alt="游戏设计"/></a><div class="content"><a class="title" href="/2025/03/15/%E6%B8%B8%E6%88%8F%E8%AE%BE%E8%AE%A1/%E6%B8%B8%E6%88%8F%E8%AE%BE%E8%AE%A1/" title="游戏设计">游戏设计</a><time datetime="2025-03-15T02:03:30.012Z" title="Created 2025-03-15 10:03:30">2025-03-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/03/15/%E6%9D%82%E9%A1%B9/%E6%B8%B8%E6%88%8F%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/" title="游戏源码解析"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="https://files.wujicode.cn/w/open/dnf_universe_app/qRlN5U00.jpg?_r_=32a5b4e6-81b1-27ba-fa65-bea0be242165" onerror="this.onerror=null;this.src='https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg'" alt="游戏源码解析"/></a><div class="content"><a class="title" href="/2025/03/15/%E6%9D%82%E9%A1%B9/%E6%B8%B8%E6%88%8F%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/" title="游戏源码解析">游戏源码解析</a><time datetime="2025-03-15T02:03:30.008Z" title="Created 2025-03-15 10:03:30">2025-03-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/03/15/%E6%9D%82%E9%A1%B9/%E5%B0%8F%E8%AF%B4/" title="怪物猎人伤害"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="https://vfiles.gtimg.cn/wuji_open/wupload/dnf_universe_data.picture_info/30b81227_-i6IfCke6si.jpg?_r_=d291b70b-f077-b662-e65d-4e9333a597b6" onerror="this.onerror=null;this.src='https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg'" alt="怪物猎人伤害"/></a><div class="content"><a class="title" href="/2025/03/15/%E6%9D%82%E9%A1%B9/%E5%B0%8F%E8%AF%B4/" title="怪物猎人伤害">怪物猎人伤害</a><time datetime="2025-03-15T02:03:30.005Z" title="Created 2025-03-15 10:03:30">2025-03-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/03/15/%E6%9D%82%E9%A1%B9/%E5%B0%8F%E8%AF%B4%20-%20%E5%89%AF%E6%9C%AC/" title="怪物猎人伤害"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="https://vfiles.gtimg.cn/xy_open/wupload/xy/dnf_universe_app/2RSwZFEA.jpg?_r_=8fd4d3d5-a339-f031-f687-43fd90f45d2a" onerror="this.onerror=null;this.src='https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg'" alt="怪物猎人伤害"/></a><div class="content"><a class="title" href="/2025/03/15/%E6%9D%82%E9%A1%B9/%E5%B0%8F%E8%AF%B4%20-%20%E5%89%AF%E6%9C%AC/" title="怪物猎人伤害">怪物猎人伤害</a><time datetime="2025-03-15T02:03:30.004Z" title="Created 2025-03-15 10:03:30">2025-03-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/03/15/%E6%9D%82%E9%A1%B9/%E4%BC%A4%E5%AE%B3%E8%AE%A1%E7%AE%97/" title="怪物猎人伤害"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="https://files.wujicode.cn/w/open/dnf_universe_app/rxIcYQoH.jpg?_r_=18ab7eed-59a7-bbd1-100d-7693c8773ff0" onerror="this.onerror=null;this.src='https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg'" alt="怪物猎人伤害"/></a><div class="content"><a class="title" href="/2025/03/15/%E6%9D%82%E9%A1%B9/%E4%BC%A4%E5%AE%B3%E8%AE%A1%E7%AE%97/" title="怪物猎人伤害">怪物猎人伤害</a><time datetime="2025-03-15T02:03:30.002Z" title="Created 2025-03-15 10:03:30">2025-03-15</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div id="footer_deal"><a class="deal_link" href="mailto:anzhiyu-c@qq.com" title="email"><i class="anzhiyufont anzhiyu-icon-envelope"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://weibo.com/u/6378063631" title="微博"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://www.facebook.com/profile.php?id=100092208016287&amp;sk=about" title="facebook"><i class="anzhiyufont anzhiyu-icon-facebook1"></i></a><a class="deal_link" href="/atom.xml" title="RSS"><i class="anzhiyufont anzhiyu-icon-rss"></i></a><img class="footer_mini_logo" title="返回顶部" alt="返回顶部" onclick="anzhiyu.scrollToDest(0, 500)" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="img/touxiang.jpg" size="50px"/><a class="deal_link" target="_blank" rel="noopener" href="https://github.com/Luojiangbao015" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://space.bilibili.com/253251579" title="Bilibili"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://www.douyin.com/user/self?from_tab_name=main" title="抖音"><i class="anzhiyufont anzhiyu-icon-tiktok"></i></a><a class="deal_link" href="/copyright" title="CC"><i class="anzhiyufont anzhiyu-icon-copyright-line"></i></a></div><div id="workboard"><img class="workSituationImg boardsign" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.0.4/img/badge/安知鱼-上班摸鱼中.svg" alt="距离月入25k也就还差一个大佬带我~" title="距离月入25k也就还差一个大佬带我~"/><div id="runtimeTextTip"></div></div><div id="anzhiyu-footer"><div class="footer-group"><div class="footer-title">服务</div><div class="footer-links"><a class="footer-item" title="51la统计" target="_blank" rel="noopener" href="https://v6.51.la/">51la统计</a><a class="footer-item" title="十年之约" target="_blank" rel="noopener" href="https://www.foreverblog.cn/">十年之约</a><a class="footer-item" title="开往" target="_blank" rel="noopener" href="https://github.com/travellings-link/travellings">开往</a></div></div><div class="footer-group"><div class="footer-title">主题</div><div class="footer-links"><a class="footer-item" title="文档" href="/docs/">文档</a><a class="footer-item" title="源码" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu">源码</a><a class="footer-item" title="更新日志" href="/update/">更新日志</a></div></div><div class="footer-group"><div class="footer-title">导航</div><div class="footer-links"><a class="footer-item" title="即刻短文" href="/essay/">即刻短文</a><a class="footer-item" title="友链文章" href="/fcircle/">友链文章</a><a class="footer-item" title="留言板" href="/comments/">留言板</a></div></div><div class="footer-group"><div class="footer-title">协议</div><div class="footer-links"><a class="footer-item" title="隐私协议" href="/privacy/">隐私协议</a><a class="footer-item" title="Cookies" href="/cookies/">Cookies</a><a class="footer-item" title="版权协议" href="/copyright/">版权协议</a></div></div><div class="footer-group"><div class="footer-title-group"><div class="footer-title">友链</div><a class="random-friends-btn" id="footer-random-friends-btn" href="javascript:addFriendLinksInFooter();" title="换一批友情链接"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right"></i></a></div><div class="footer-links" id="friend-links-in-footer"></div></div></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo_v5.4.0" title="博客框架为Hexo_v5.4.0"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.1.5/img/badge/Frame-Hexo.svg" alt="博客框架为Hexo_v5.4.0"/></a><a class="github-badge" target="_blank" href="https://blog.anheyu.com/" style="margin-inline:5px" data-title="本站使用AnZhiYu主题" title="本站使用AnZhiYu主题"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.9/img/Theme-AnZhiYu-2E67D3.svg" alt="本站使用AnZhiYu主题"/></a><a class="github-badge" target="_blank" href="https://www.dogecloud.com/" style="margin-inline:5px" data-title="本站使用多吉云为静态资源提供CDN加速" title="本站使用多吉云为静态资源提供CDN加速"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.2.0/img/badge/CDN-多吉云-3693F3.svg" alt="本站使用多吉云为静态资源提供CDN加速"/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="本站项目由Github托管" title="本站项目由Github托管"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.1.5/img/badge/Source-Github.svg" alt="本站项目由Github托管"/></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" data-title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.2.0/img/badge/Copyright-BY-NC-SA.svg" alt="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"/></a></p></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2025 By <a class="footer-bar-link" href="/" title="凝雨" target="_blank">凝雨</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a><a class="footer-bar-link" target="_blank" rel="noopener" href="https://image.anheyu.com" title="图床">图床</a><a class="footer-bar-link" target="_blank" rel="noopener" href="https://beian.miit.gov.cn/" title="黔ICP备-4204490号">黔ICP备-4204490号</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">Articles</div><div class="length-num">37</div></a><a href="/tags/" title="tag"><div class="headline">Tags</div><div class="length-num">4</div></a><a href="/categories/" title="category"><div class="headline">Categories</div><div class="length-num">8</div></a></div><span class="sidebar-menu-item-title">Function</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="Display Mode"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>Display Mode</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://space.bilibili.com/253251579" title="哔哩哔哩"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="https://th.bing.com/th?id=ODLS.1e67f861-d980-4c01-ba66-9450f90172f4&amp;w=32&amp;h=32&amp;qlt=96&amp;pcl=fffffc&amp;o=6&amp;cb=15&amp;pid=1.2" alt="哔哩哔哩"/><span class="back-menu-item-text">哔哩哔哩</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://blender.kim/" title="魔酷网"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="https://th.bing.com/th?id=ODLS.88012746-d99b-4589-a17c-d5eeaad474fd&amp;w=32&amp;h=32&amp;qlt=99&amp;pcl=fffffc&amp;o=6&amp;cb=15&amp;pid=1.2" alt="魔酷网"/><span class="back-menu-item-text">魔酷网</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://www.aplaybox.com/" title="模之屋"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="https://th.bing.com/th?id=ODLS.221b96bc-0e7f-4f7d-b980-a051789b763b&amp;w=32&amp;h=32&amp;qlt=90&amp;pcl=fffffa&amp;o=6&amp;cb=15&amp;pid=1.2" alt="模之屋"/><span class="back-menu-item-text">模之屋</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://huaban.com/follow" title="花瓣"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="https://th.bing.com/th?id=ODLS.9e0310ad-0fa0-486f-8c12-81bcf016e199&amp;w=32&amp;h=32&amp;qlt=98&amp;pcl=fffffc&amp;o=6&amp;cb=15&amp;pid=1.2" alt="花瓣"/><span class="back-menu-item-text">花瓣</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://www.zhihu.com/people/35-4-25-32" title="知乎"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://files.wujicode.cn/w/open/dnf_universe_app/r4w7VxTy.jpeg&quot;" data-lazy-src="https://th.bing.com/th?id=ODLS.66059014-8637-4840-b8a6-78e2a6e07c34&amp;w=17&amp;h=17&amp;o=6&amp;cb=15&amp;pid=1.2" alt="知乎"/><span class="back-menu-item-text">知乎</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><i class="anzhiyufont anzhiyu-icon-artstation faa-tada" style="font-size: 0.9em;"></i><span> 朋友圈</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 追番页</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/htim/"><i class="anzhiyufont anzhiyu-icon-fan faa-tada" style="font-size: 0.9em;"></i><span> 小空调</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 闲言碎语</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/equipment/"><i class="anzhiyufont anzhiyu-icon-dice-d20 faa-tada" style="font-size: 0.9em;"></i><span> 我的装备</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/%E5%8F%98%E9%87%8F/" style="font-size: 0.88rem;">变量<sup>5</sup></a><a href="/tags/%E5%A4%87%E5%BF%98%E5%BD%95/" style="font-size: 0.88rem;">备忘录<sup>1</sup></a><a href="/tags/%E5%AD%A6%E4%B9%A0/" style="font-size: 0.88rem;">学习<sup>35</sup></a><a href="/tags/%E8%84%9A%E6%9C%AC/" style="font-size: 0.88rem;">脚本<sup>1</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="Switch Between Traditional Chinese And Simplified Chinese">繁</button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><button id="go-up" type="button" title="Back To Top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="is-center" id="loading-database"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-pulse-icon"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("15/03/2025 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2025 By 安知鱼 V1.6.14",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 凝雨 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><script async="async">(function () {
  var grt = new Date("15/03/2025 00:00:00"); //设置网站上线时间
  var now = new Date();
  var dnum;
  var hnum;
  var mnum;
  var snum;
  var nowHour;

  // 计算并更新天数、小时数、分钟数和秒数
  function updateTime() {
    now = new Date(); // 更新 now 的值
    nowHour = now.getHours(); // 更新 nowHour 的值
    var days = (now - grt) / 1000 / 60 / 60 / 24;
    dnum = Math.floor(days);
    var hours = (now - grt) / 1000 / 60 / 60 - 24 * dnum;
    hnum = Math.floor(hours);
    if (String(hnum).length == 1) {
      hnum = "0" + hnum;
    }
    var minutes = (now - grt) / 1000 / 60 - 24 * 60 * dnum - 60 * hnum;
    mnum = Math.floor(minutes);
    if (String(mnum).length == 1) {
      mnum = "0" + mnum;
    }
    var seconds = (now - grt) / 1000 - 24 * 60 * 60 * dnum - 60 * 60 * hnum - 60 * mnum;
    snum = Math.round(seconds);
    if (String(snum).length == 1) {
      snum = "0" + snum;
    }
  }

  // 更新网页中显示的网站运行时间
  function updateHtml() {
    const footer = document.getElementById("footer");
    if (!footer) return
    let currentTimeHtml = "";
    if (nowHour < 18 && nowHour >= 9) {
      // 如果是上班时间，默认就是"安知鱼-上班摸鱼中.svg"图片，不需要更改
      currentTimeHtml = `本站居然运行了 ${dnum} 天<span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    } else {
      // 如果是下班时间，插入"安知鱼-下班啦.svg"图片
      let img = document.querySelector("#workboard .workSituationImg");
      if (img != null) {
        img.src = "https://npm.elemecdn.com/anzhiyu-blog@2.0.4/img/badge/安知鱼-下班啦.svg";
        img.title = "下班了就该开开心心的玩耍，嘿嘿~";
        img.alt = "下班了就该开开心心的玩耍，嘿嘿~";
      }

      currentTimeHtml = `本站居然运行了 ${dnum} 天<span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    }

    if (document.getElementById("runtimeTextTip")) {
      document.getElementById("runtimeTextTip").innerHTML = currentTimeHtml;
    }
  }

  setInterval(() => {
    updateTime();
    updateHtml();
  }, 1000);
})();</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(() => {
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: '',
      region: '',
      onCommentLoaded: () => {
        anzhiyu.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') setTimeout(runFn,0)
    else getScript('https://cdn.cbd.int/twikoo@1.6.39/dist/twikoo.all.min.js').then(runFn)
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: '',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const runFn = () => {
    init();
    
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) anzhiyu.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else {
      loadTwikoo()
    }
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script><script>(() => {
  let initFn = window.walineFn || null

  const initWaline = (Fn) => {
    const waline = Fn(Object.assign({
      el: '#waline-wrap',
      serverURL: '',
      pageview: false,
      dark: 'html[data-theme="dark"]',
      path: window.location.pathname,
      comment: false,
      imageUploader: true,
    }, null))

    const destroyWaline = () => {
      waline.destroy()
    }

    anzhiyu.addGlobalFn('pjax', destroyWaline, 'destroyWaline')
  }

  const loadWaline = async () => {
    if (initFn) initWaline(initFn)
    else {
      await getCSS('https://cdn.cbd.int/@waline/client@3.1.3/dist/waline.css')
      if (false) await getCSS('https://cdn.cbd.int/@waline/client@3.1.3/dist/waline-meta.css')
      const { init } = await import('https://cdn.cbd.int/@waline/client@3.1.3/dist/waline.js')
      initFn = init || Waline.init
      initWaline(initFn)
      window.walineFn = initFn
    }
  }

  if ('Twikoo' === 'Waline' || !false) {
    if (false) anzhiyu.loadComment(document.getElementById('waline-wrap'),loadWaline)
    else setTimeout(loadWaline, 0)
  } else {
    window.loadOtherComment = loadWaline
  }
})()</script><input type="hidden" name="page-type" id="page-type" value="post"></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[image]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[link]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[code]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getComment = () => {
    const runTwikoo = () => {
      twikoo.getRecentComments({
        envId: '',
        region: '',
        pageSize: 6,
        includeReply: true
      }).then(function (res) {
        const twikooArray = res.map(e => {
          return {
            'content': changeContent(e.comment),
            'avatar': e.avatar,
            'nick': e.nick,
            'url': e.url + '#' + e.id,
            'date': new Date(e.created).toISOString()
          }
        })

        saveToLocal.set('twikoo-newest-comments', JSON.stringify(twikooArray), 10/(60*24))
        generateHtml(twikooArray)
      }).catch(function (err) {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.textContent= "Unable to get the data, please make sure the settings are correct."
      })
    }

    if (typeof twikoo === 'object') {
      runTwikoo()
    } else {
      getScript('https://cdn.cbd.int/twikoo@1.6.39/dist/twikoo.all.min.js').then(runTwikoo)
    }
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'><div class='name'><span>${array[i].nick} </span></div></a>`
        }
        
        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <time datetime="${array[i].date}">${anzhiyu.diffDate(array[i].date, true)}</time></div>
        </div>`
      }
    } else {
      result += 'No Comment'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom && ($dom.innerHTML= result)
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('twikoo-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script async data-pjax src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.1/bubble/bubble.js"></script><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><script src="/js/anzhiyu/right_click_menu.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["meta[property=\"og:image\"]","meta[property=\"og:title\"]","meta[property=\"og:url\"]","meta[property=\"og:type\"]","meta[property=\"og:site_name\"]","meta[property=\"og:description\"]","head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>